<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/yuena.blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/yuena.blog/images/yuena.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/yuena.blog/images/yuena.ico">
  <link rel="mask-icon" href="/yuena.blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/yuena.blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-flat-top.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dmyuena.github.io","root":"/yuena.blog/","images":"/yuena.blog/images","scheme":"Gemini","darkmode":false,"version":"8.18.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/yuena.blog/js/config.js"></script>

    <meta name="description" content="51单片机第一章：单片机的简单介绍 单片机，Micro Controller Unit，简称 MCU   内部集成了CPU、RAM、ROM、定时器、中断系统、通讯接口等  单片机的任务是信息采集、处理和控制硬件设备">
<meta property="og:type" content="article">
<meta property="og:title" content="51单片机-江协科技">
<meta property="og:url" content="https://dmyuena.github.io/yuena.blog/2023/08/30/51%E5%8D%95%E7%89%87%E6%9C%BA-%E6%B1%9F%E5%8D%8F%E7%A7%91%E6%8A%80/index.html">
<meta property="og:site_name" content="YueNa&#39;s Blog">
<meta property="og:description" content="51单片机第一章：单片机的简单介绍 单片机，Micro Controller Unit，简称 MCU   内部集成了CPU、RAM、ROM、定时器、中断系统、通讯接口等  单片机的任务是信息采集、处理和控制硬件设备">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009202431601.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009202617702.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009204532095.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009204901978.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009205542660.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009205830866.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009210222750.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009210606898.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009211056269.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009215042252.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231031220708382.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009212157322.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106214734909.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231116223252781.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231116223519140.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231116223814224.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231116224226825.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009215443743.png">
<meta property="og:image" content="c:/Users/86135/AppData/Roaming/Typora/typora-user-images/image-20231106180639759.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231117140739012.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118175438105.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106213635889.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106214008455.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-11-06%20215245.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106215810569.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009212739056.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106183927880.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106185015203.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106191647973.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106192120556.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106193327684.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106192935212.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106194539340.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106211237119.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106220518747.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231116221307347.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118163512283.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118163842151.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118164244096.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118164506057.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118164734500.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118165011098.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118183438645.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118183545889.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118183733337.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118183818544.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118201814045.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118220728807.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625232927776.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625233318680.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625233759954.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625234255605.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625234437767.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625235150291.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625235325174.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625235439511.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625235739307.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625235914088.png">
<meta property="article:published_time" content="2023-08-30T15:54:06.000Z">
<meta property="article:modified_time" content="2024-06-30T14:24:45.725Z">
<meta property="article:author" content="chouzhen">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009202431601.png">


<link rel="canonical" href="https://dmyuena.github.io/yuena.blog/2023/08/30/51%E5%8D%95%E7%89%87%E6%9C%BA-%E6%B1%9F%E5%8D%8F%E7%A7%91%E6%8A%80/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dmyuena.github.io/yuena.blog/2023/08/30/51%E5%8D%95%E7%89%87%E6%9C%BA-%E6%B1%9F%E5%8D%8F%E7%A7%91%E6%8A%80/","path":"2023/08/30/51单片机-江协科技/","title":"51单片机-江协科技"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>51单片机-江协科技 | YueNa's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/yuena.blog/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/yuena.blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">YueNa's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">秋窗犹曙色,落木更天风</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/yuena.blog/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/yuena.blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">12</span></a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#51%E5%8D%95%E7%89%87%E6%9C%BA"><span class="nav-number">1.</span> <span class="nav-text">51单片机</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0%EF%BC%9A"><span class="nav-number">1.1.</span> <span class="nav-text">第一章：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E7%89%87%E6%9C%BA%E7%9A%84%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.1.1.</span> <span class="nav-text">单片机的简单介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#STC89C52%E5%8D%95%E7%89%87%E6%9C%BA"><span class="nav-number">1.1.2.</span> <span class="nav-text">STC89C52单片机</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">命名规则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%95%E8%84%9A"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">引脚</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#K-5%E8%BD%AF%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.1.3.</span> <span class="nav-text">K-5软件的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B0%E5%BB%BA%E5%B7%A5%E7%A8%8B"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">新建工程</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6"><span class="nav-number">1.1.3.1.1.</span> <span class="nav-text">创建文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E8%8A%AF%E7%89%87%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.1.3.1.2.</span> <span class="nav-text">选择芯片类型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B0%E5%BB%BA-C%E6%96%87%E4%BB%B6"><span class="nav-number">1.1.3.1.3.</span> <span class="nav-text">新建.C文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8B%BE%E9%80%89%E7%94%9F%E6%88%90-hex%E6%96%87%E4%BB%B6"><span class="nav-number">1.1.3.1.4.</span> <span class="nav-text">勾选生成.hex文件</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E6%94%B9%E5%AD%97%E4%BD%93"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">更改字体</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98"><span class="nav-number">1.1.3.3.</span> <span class="nav-text">中文乱码问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7"><span class="nav-number">1.1.3.4.</span> <span class="nav-text">软件使用技巧</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#STC-ISP%E8%BD%AF%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.1.4.</span> <span class="nav-text">STC-ISP软件的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%83%A7%E5%BD%95%E7%A8%8B%E5%BA%8F"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">烧录程序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BB%B6%E8%BF%9F%E6%97%B6%E9%97%B4%EF%BC%88%E7%94%9F%E6%88%90delay%E5%87%BD%E6%95%B0%EF%BC%89"><span class="nav-number">1.1.4.2.</span> <span class="nav-text">延迟时间（生成delay函数）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E6%97%B6%E5%99%A8%E8%AE%A1%E7%AE%97%E5%99%A8"><span class="nav-number">1.1.4.3.</span> <span class="nav-text">定时器计算器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A2%E7%89%B9%E7%8E%87%E8%AE%A1%E7%AE%97%E5%99%A8"><span class="nav-number">1.1.4.4.</span> <span class="nav-text">波特率计算器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96%E7%BC%96%E7%A8%8B"><span class="nav-number">1.1.5.</span> <span class="nav-text">模块化编程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#C%E9%A2%84%E7%BC%96%E8%AF%91"><span class="nav-number">1.1.6.</span> <span class="nav-text">C预编译</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E5%B7%B2%E5%88%9B%E5%BB%BA%E7%9A%84%E5%A4%B4%E6%96%87%E4%BB%B6"><span class="nav-number">1.1.7.</span> <span class="nav-text">添加已创建的头文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9ALED"><span class="nav-number">1.2.</span> <span class="nav-text">第二章：LED</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%E5%9B%BE"><span class="nav-number">1.2.1.</span> <span class="nav-text">原理图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%82%B9%E4%BA%AE%E7%AC%AC%E4%B8%80%E4%B8%AALED%E7%81%AF"><span class="nav-number">1.2.2.</span> <span class="nav-text">点亮第一个LED灯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LED%E9%97%AA%E7%83%81"><span class="nav-number">1.2.3.</span> <span class="nav-text">LED闪烁</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LED%E6%B5%81%E6%B0%B4%E7%81%AF"><span class="nav-number">1.2.4.</span> <span class="nav-text">LED流水灯</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0%EF%BC%9A%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE"><span class="nav-number">1.3.</span> <span class="nav-text">第三章：独立按键</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%E5%9B%BE-1"><span class="nav-number">1.3.1.</span> <span class="nav-text">原理图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6LED%E4%BA%AE%E7%81%AD"><span class="nav-number">1.3.2.</span> <span class="nav-text">独立按键控制LED亮灭</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6LED%E7%8A%B6%E6%80%81"><span class="nav-number">1.3.3.</span> <span class="nav-text">独立按键控制LED状态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6LED%E6%98%BE%E7%A4%BA%E4%BA%8C%E8%BF%9B%E5%88%B6"><span class="nav-number">1.3.4.</span> <span class="nav-text">独立按键控制LED显示二进制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6LED%E7%A7%BB%E4%BD%8D"><span class="nav-number">1.3.5.</span> <span class="nav-text">独立按键控制LED移位</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0%EF%BC%9A%E6%95%B0%E7%A0%81%E7%AE%A1"><span class="nav-number">1.4.</span> <span class="nav-text">第四章：数码管</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%E5%9B%BE-2"><span class="nav-number">1.4.1.</span> <span class="nav-text">原理图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA"><span class="nav-number">1.4.2.</span> <span class="nav-text">静态数码管显示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA"><span class="nav-number">1.4.3.</span> <span class="nav-text">动态数码管显示</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0%EF%BC%9ALCD1602%E8%B0%83%E8%AF%95"><span class="nav-number">1.5.</span> <span class="nav-text">第五章：LCD1602调试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0%EF%BC%9A%E7%9F%A9%E9%98%B5%E9%94%AE%E7%9B%98"><span class="nav-number">1.6.</span> <span class="nav-text">第六章：矩阵键盘</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%E5%9B%BE-3"><span class="nav-number">1.6.1.</span> <span class="nav-text">原理图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E9%94%AE%E7%9B%981"><span class="nav-number">1.6.2.</span> <span class="nav-text">矩阵键盘1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E9%94%AE%E7%9B%98%E5%AF%86%E7%A0%81%E9%94%81"><span class="nav-number">1.6.3.</span> <span class="nav-text">矩阵键盘密码锁</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%83%E7%AB%A0%EF%BC%9A%E5%AE%9A%E6%97%B6%E5%99%A8"><span class="nav-number">1.7.</span> <span class="nav-text">第七章：定时器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E6%97%B6%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.7.1.</span> <span class="nav-text">定时器的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6LCD%E6%B5%81%E6%B0%B4%E7%81%AF%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.7.2.</span> <span class="nav-text">按键控制LCD流水灯模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E6%97%B6%E5%99%A8%E6%97%B6%E9%92%9F"><span class="nav-number">1.7.3.</span> <span class="nav-text">定时器时钟</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%85%AB%E7%AB%A0%EF%BC%9A%E4%B8%B2%E5%8F%A3"><span class="nav-number">1.8.</span> <span class="nav-text">第八章：串口</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%B2%E5%8F%A3%E9%80%9A%E8%AE%AF"><span class="nav-number">1.8.1.</span> <span class="nav-text">串口通讯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%B2%E5%8F%A3%E5%90%91%E7%94%B5%E8%84%91%E5%8F%91%E9%80%81%E6%95%B0%E6%8D%AE"><span class="nav-number">1.8.2.</span> <span class="nav-text">串口向电脑发送数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%B5%E8%84%91%E9%80%9A%E8%BF%87%E4%B8%B2%E5%8F%A3%E6%8E%A7%E5%88%B6LED"><span class="nav-number">1.8.3.</span> <span class="nav-text">电脑通过串口控制LED</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B9%9D%E7%AB%A0%EF%BC%9ALED%E7%82%B9%E9%98%B5%E5%B1%8F"><span class="nav-number">1.9.</span> <span class="nav-text">第九章：LED点阵屏</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%82%B9%E9%98%B5%E5%B1%8F%E5%8E%9F%E7%90%86"><span class="nav-number">1.9.1.</span> <span class="nav-text">点阵屏原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LED%E7%82%B9%E9%98%B5%E5%B1%8F%E6%98%BE%E7%A4%BA%E5%9B%BE%E5%BD%A2"><span class="nav-number">1.9.2.</span> <span class="nav-text">LED点阵屏显示图形</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LED%E7%82%B9%E9%98%B5%E5%B1%8F%E6%98%BE%E7%A4%BA%E5%8A%A8%E7%94%BB"><span class="nav-number">1.9.3.</span> <span class="nav-text">LED点阵屏显示动画</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E7%AB%A0%EF%BC%9ADS1302%E6%97%B6%E9%92%9F"><span class="nav-number">1.10.</span> <span class="nav-text">第十章：DS1302时钟</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DS1302"><span class="nav-number">1.10.1.</span> <span class="nav-text">DS1302</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%93%9D%E6%A1%A5%E6%9D%AF"><span class="nav-number">2.</span> <span class="nav-text">蓝桥杯</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E6%97%B6%E5%99%A8-interrupt"><span class="nav-number">2.1.</span> <span class="nav-text">定时器 interrupt</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F-int-%E5%92%8C-char-%E7%9A%84%E5%8F%96%E5%80%BC%E8%8C%83%E5%9B%B4-%EF%BC%81%EF%BC%81%EF%BC%81%EF%BC%81"><span class="nav-number">2.2.</span> <span class="nav-text">注意 int 和 char 的取值范围 ！！！！</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%96%E6%95%B0%E7%9B%B8%E4%B9%98%E6%97%B6%EF%BC%8C%E6%B3%A8%E6%84%8F%E5%8F%96%E5%80%BC%E8%8C%83%E5%9B%B4"><span class="nav-number">2.3.</span> <span class="nav-text">取数相乘时，注意取值范围</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E5%AE%9A%E7%9A%84%E6%B8%A9%E5%BA%A6%E5%8F%82%E6%95%B0%E5%9C%A8%E9%80%80%E5%87%BA%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE%E7%95%8C%E9%9D%A2%E6%97%B6%E7%94%9F%E6%95%88"><span class="nav-number">2.3.1.</span> <span class="nav-text">设定的温度参数在退出参数设置界面时生效</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%9D%E8%B7%AF"><span class="nav-number">2.4.</span> <span class="nav-text">思路</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8F"><span class="nav-number">2.4.1.</span> <span class="nav-text">变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%A8seg%E7%9A%84%E6%98%BE%E7%A4%BA%E7%95%8C%E9%9D%A2"><span class="nav-number">2.4.2.</span> <span class="nav-text">在seg的显示界面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%95%B0%E6%8D%AE%E6%98%BE%E7%A4%BA"><span class="nav-number">2.4.2.1.</span> <span class="nav-text">1. 数据显示</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE"><span class="nav-number">2.4.2.2.</span> <span class="nav-text">2.参数设置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%95%8C%E9%9D%A2%E5%88%87%E6%8D%A2"><span class="nav-number">2.5.</span> <span class="nav-text">界面切换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DS1302-%E6%97%B6%E9%92%9F"><span class="nav-number">2.6.</span> <span class="nav-text">DS1302  时钟</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DS18B20-%E6%B8%A9%E5%BA%A6"><span class="nav-number">2.7.</span> <span class="nav-text">DS18B20 温度</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%89%E9%94%AE-%E6%91%81%E7%9D%80%E4%B8%8D%E5%8A%A8-%E5%92%8C-%E6%9D%BE%E5%BC%80"><span class="nav-number">2.8.</span> <span class="nav-text">按键  摁着不动 和 松开</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NE555-%E6%B5%8B%E8%AF%95%E9%A2%91%E7%8E%87"><span class="nav-number">2.9.</span> <span class="nav-text">NE555 测试频率</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PCF8591-AD-DA-%E8%BD%AC%E6%8D%A2"><span class="nav-number">2.10.</span> <span class="nav-text">PCF8591      AD &#x2F; DA 转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AT24C02-%E2%80%94-EEPROM-%E5%AD%98%E5%82%A8%E5%99%A8"><span class="nav-number">2.11.</span> <span class="nav-text">AT24C02  —&gt; EEPROM  存储器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%B2%E5%8F%A3"><span class="nav-number">2.12.</span> <span class="nav-text">串口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B6%85%E5%A3%B0%E6%B3%A2"><span class="nav-number">2.13.</span> <span class="nav-text">超声波</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PWM"><span class="nav-number">2.14.</span> <span class="nav-text">PWM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B9%9D%E5%B1%8A%E7%9C%81%E8%B5%9B"><span class="nav-number">2.15.</span> <span class="nav-text">第九届省赛</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%85%AB%E5%B1%8A-%E7%9C%81%E8%B5%9B"><span class="nav-number">2.16.</span> <span class="nav-text">第八届 省赛</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%83%E5%B1%8A%E7%9C%81%E8%B5%9B"><span class="nav-number">2.17.</span> <span class="nav-text">第七届省赛</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E5%B1%8A%E7%9C%81%E8%B5%9B"><span class="nav-number">2.18.</span> <span class="nav-text">第六届省赛</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E5%B1%8A%E7%9C%81%E8%B5%9B"><span class="nav-number">2.19.</span> <span class="nav-text">第五届省赛</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%B4%E6%96%87%E4%BB%B6"><span class="nav-number">2.20.</span> <span class="nav-text">头文件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%83%AD%E5%A4%A9%E7%A5%A5%E2%80%94-%E5%AE%9A%E6%97%B6%E5%99%A8%E4%B8%AD%E6%96%AD"><span class="nav-number">3.</span> <span class="nav-text">郭天祥—&gt; 定时器中断</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%83%AD%E5%A4%A9%E7%A5%A5-%E4%B8%B2%E5%8F%A3"><span class="nav-number">4.</span> <span class="nav-text">郭天祥-&gt;串口</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="chouzhen"
      src="/yuena.blog/images/yuena.gif">
  <p class="site-author-name" itemprop="name">chouzhen</p>
  <div class="site-description" itemprop="description">YueNa的博客</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/yuena.blog/archives/">
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/dmyuena" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;dmyuena" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:2237076291@qq.com" title="E-Mail → mailto:2237076291@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title">
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="ttps://xbww38261.xyz/" title="ttps:&#x2F;&#x2F;xbww38261.xyz&#x2F;" rel="noopener" target="_blank">梯子</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://jycblog.gitee.io/#indexCard" title="https:&#x2F;&#x2F;jycblog.gitee.io&#x2F;#indexCard" rel="noopener" target="_blank">一言</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://dhndzwxj.vercel.app/" title="https:&#x2F;&#x2F;dhndzwxj.vercel.app&#x2F;" rel="noopener" target="_blank">揭晓</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://namic00.github.io/" title="https:&#x2F;&#x2F;namic00.github.io&#x2F;" rel="noopener" target="_blank">C/C</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dmyuena.github.io/yuena.blog/2023/08/30/51%E5%8D%95%E7%89%87%E6%9C%BA-%E6%B1%9F%E5%8D%8F%E7%A7%91%E6%8A%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/yuena.blog/images/yuena.gif">
      <meta itemprop="name" content="chouzhen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YueNa's Blog">
      <meta itemprop="description" content="YueNa的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="51单片机-江协科技 | YueNa's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          51单片机-江协科技
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-08-30 23:54:06" itemprop="dateCreated datePublished" datetime="2023-08-30T23:54:06+08:00">2023-08-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-06-30 22:24:45" itemprop="dateModified" datetime="2024-06-30T22:24:45+08:00">2024-06-30</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>27k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>25 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="51单片机"><a href="#51单片机" class="headerlink" title="51单片机"></a>51单片机</h1><h2 id="第一章："><a href="#第一章：" class="headerlink" title="第一章："></a>第一章：</h2><h3 id="单片机的简单介绍"><a href="#单片机的简单介绍" class="headerlink" title="单片机的简单介绍"></a>单片机的简单介绍</h3><ul>
<li><p>单片机，Micro Controller Unit，简称 MCU </p>
</li>
<li><p>内部集成了CPU、RAM、ROM、定时器、中断系统、通讯接口等</p>
</li>
<li><p>单片机的任务是信息采集、处理和控制硬件设备</p>
</li>
</ul>
<p>单片机算是一个袖珍版计算机，一个芯片就能构成完整的计算机系统。但在性能上，与计算机相差甚远，但单片机成本低、体积小、结构简单，在生活和工业控制领域大有所用</p>
<h3 id="STC89C52单片机"><a href="#STC89C52单片机" class="headerlink" title="STC89C52单片机"></a>STC89C52单片机</h3><ul>
<li>位数：8位</li>
<li>RAM：512字节</li>
<li>ROM：8K（Flash）</li>
<li>工作频率：12MHz</li>
</ul>
<h4 id="命名规则"><a href="#命名规则" class="headerlink" title="命名规则"></a>命名规则</h4><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009202431601.png" alt="image-20231009202431601" style="zoom:50%;" />

<h4 id="引脚"><a href="#引脚" class="headerlink" title="引脚"></a>引脚</h4><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009202617702.png" alt="image-20231009202617702" style="zoom:50%;" />

<h3 id="K-5软件的使用"><a href="#K-5软件的使用" class="headerlink" title="K-5软件的使用"></a>K-5软件的使用</h3><h4 id="新建工程"><a href="#新建工程" class="headerlink" title="新建工程"></a>新建工程</h4><h5 id="创建文件"><a href="#创建文件" class="headerlink" title="创建文件"></a>创建文件</h5><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009204532095.png" alt="image-20231009204532095" style="zoom:33%;" />



<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009204901978.png" alt="image-20231009204901978" style="zoom:33%;" />

<h5 id="选择芯片类型"><a href="#选择芯片类型" class="headerlink" title="选择芯片类型"></a>选择芯片类型</h5><blockquote>
<p>K_5是国外的软件，没有STC类型的，可用AT代替 (效果一样)</p>
</blockquote>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009205542660.png" alt="image-20231009205542660" style="zoom: 50%;" />

<ul>
<li>选择 否 即可</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009205830866.png" alt="image-20231009205830866" style="zoom: 50%;" />

<h5 id="新建-C文件"><a href="#新建-C文件" class="headerlink" title="新建.C文件"></a>新建.C文件</h5><ul>
<li>点击“Add New —-”</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009210222750.png" alt="image-20231009210222750" style="zoom:50%;" />

<ul>
<li>选择C File，取名后，点击Add</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009210606898.png" alt="image-20231009210606898" style="zoom: 33%;" />



<ul>
<li>在如下界面编辑代码</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009211056269.png" alt="image-20231009211056269" style="zoom: 33%;" />



<h5 id="勾选生成-hex文件"><a href="#勾选生成-hex文件" class="headerlink" title="勾选生成.hex文件"></a>勾选生成.hex文件</h5><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009215042252.png" alt="image-20231009215042252" style="zoom: 33%;" />



<ul>
<li>代码编辑完成后F7即可生成文件</li>
</ul>
<h4 id="更改字体"><a href="#更改字体" class="headerlink" title="更改字体"></a>更改字体</h4><p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231031220708382.png" alt="image-20231031220708382"></p>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009212157322.png" alt="image-20231009212157322" style="zoom:33%;" />



<h4 id="中文乱码问题"><a href="#中文乱码问题" class="headerlink" title="中文乱码问题"></a>中文乱码问题</h4><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106214734909.png" alt="image-20231106214734909" style="zoom:67%;" />



<h4 id="软件使用技巧"><a href="#软件使用技巧" class="headerlink" title="软件使用技巧"></a>软件使用技巧</h4><p>查看模块内的函数</p>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231116223252781.png" alt="image-20231116223252781" style="zoom:50%;" />



<p>双击即可，添加快捷模版</p>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231116223519140.png" alt="image-20231116223519140" style="zoom:50%;" />



<p>在空白处右键新建，模版</p>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231116223814224.png" alt="image-20231116223814224" style="zoom:33%;" />



<ul>
<li>点击新建</li>
<li>编辑快捷模版名</li>
<li>编辑内容</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231116224226825.png" alt="image-20231116224226825" style="zoom:50%;" />

<h3 id="STC-ISP软件的使用"><a href="#STC-ISP软件的使用" class="headerlink" title="STC-ISP软件的使用"></a>STC-ISP软件的使用</h3><h4 id="烧录程序"><a href="#烧录程序" class="headerlink" title="烧录程序"></a>烧录程序</h4><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009215443743.png" alt="image-20231009215443743" style="zoom: 50%;" />

<ul>
<li>单片机型号根据自己的设备进行选择</li>
<li>设备连接电脑后会自动匹配串口号</li>
<li>点击  ‘打开程序文件’  在文件目录下的Object文件夹下选择.hex文件</li>
<li>点击下载&#x2F;编程，烧录程序</li>
<li>重启单片机即可</li>
</ul>
<h4 id="延迟时间（生成delay函数）"><a href="#延迟时间（生成delay函数）" class="headerlink" title="延迟时间（生成delay函数）"></a>延迟时间（生成delay函数）</h4><img src="C:/Users/86135/AppData/Roaming/Typora/typora-user-images/image-20231106180639759.png" alt="image-20231106180639759" style="zoom:50%;" />

<ul>
<li>选择软件延时计算器</li>
<li>选择系统频率（单片机晶振）</li>
<li>选择相应的8051指令集:STC-Y1,适用于STC89C52系列单</li>
</ul>
<h4 id="定时器计算器"><a href="#定时器计算器" class="headerlink" title="定时器计算器"></a>定时器计算器</h4><p>p18  30min</p>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231117140739012.png" alt="image-20231117140739012" style="zoom:50%;" />



<h4 id="波特率计算器"><a href="#波特率计算器" class="headerlink" title="波特率计算器"></a>波特率计算器</h4><p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118175438105.png" alt="image-20231118175438105"></p>
<h3 id="模块化编程"><a href="#模块化编程" class="headerlink" title="模块化编程"></a>模块化编程</h3><ul>
<li><p>把各个模块的代码放在不同的.c文件里</p>
</li>
<li><p>在.h文件里提供外部可调用函数的声明</p>
</li>
<li><p>其它.c文件想使用其中的代码时，只需要#include “XXX.h”文件即可。</p>
</li>
<li><p>使用模块化编程可极大的提高代码的可阅读性、可维护性、可移植性等</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106213635889.png" alt="image-20231106213635889"></p>
<h3 id="C预编译"><a href="#C预编译" class="headerlink" title="C预编译"></a>C预编译</h3><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106214008455.png" alt="image-20231106214008455" style="zoom:50%;" />

<blockquote>
<p>#ifndef  __ </p>
<p>#endif</p>
<p>成对出现</p>
</blockquote>
<h3 id="添加已创建的头文件"><a href="#添加已创建的头文件" class="headerlink" title="添加已创建的头文件"></a>添加已创建的头文件</h3><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-11-06%20215245.png" alt="屏幕截图 2023-11-06 215245" style="zoom:50%;" />



<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106215810569.png" alt="image-20231106215810569" style="zoom:50%;" />



<h2 id="第二章：LED"><a href="#第二章：LED" class="headerlink" title="第二章：LED"></a>第二章：LED</h2><h3 id="原理图"><a href="#原理图" class="headerlink" title="原理图"></a>原理图</h3><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231009212739056.png" alt="image-20231009212739056" style="zoom: 50%;" />

<p>RP7-9为保护电阻</p>
<p>P2口输出高电平，LED灭，输出低电平，LED亮</p>
<h3 id="点亮第一个LED灯"><a href="#点亮第一个LED灯" class="headerlink" title="点亮第一个LED灯"></a>点亮第一个LED灯</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    P2=<span class="number">0xFE</span>; <span class="comment">//1111 1110    </span></span><br><span class="line">    <span class="comment">//0亮1灭</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="LED闪烁"><a href="#LED闪烁" class="headerlink" title="LED闪烁"></a>LED闪烁</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;INTRINS.H&gt;</span>    <span class="comment">//_nop_();</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay500ms</span><span class="params">()</span>		<span class="comment">//延迟函数</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j, k;</span><br><span class="line"></span><br><span class="line">	_nop_();</span><br><span class="line">	i = <span class="number">4</span>;</span><br><span class="line">	j = <span class="number">205</span>;</span><br><span class="line">	k = <span class="number">187</span>;</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span> (--k);</span><br><span class="line">		&#125; <span class="keyword">while</span> (--j);</span><br><span class="line">	&#125; <span class="keyword">while</span> (--i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		P2=<span class="number">0xFE</span>;	<span class="comment">//1111 1110</span></span><br><span class="line">		Delay500ms();</span><br><span class="line">		P2=<span class="number">0xFF</span>;	<span class="comment">//1111 1111</span></span><br><span class="line">		Delay500ms();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="LED流水灯"><a href="#LED流水灯" class="headerlink" title="LED流水灯"></a>LED流水灯</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay1ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span>;		<span class="comment">//延迟函数声明</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		P2=<span class="number">0xFE</span>;<span class="comment">//1111 1110</span></span><br><span class="line">		Delay1ms(<span class="number">1000</span>);</span><br><span class="line">		P2=<span class="number">0xFD</span>;<span class="comment">//1111 1101</span></span><br><span class="line">		Delay1ms(<span class="number">1000</span>);</span><br><span class="line">		P2=<span class="number">0xFB</span>;<span class="comment">//1111 1011</span></span><br><span class="line">		Delay1ms(<span class="number">100</span>);</span><br><span class="line">		P2=<span class="number">0xF7</span>;<span class="comment">//1111 0111</span></span><br><span class="line">		Delay1ms(<span class="number">100</span>);</span><br><span class="line">		P2=<span class="number">0xEF</span>;<span class="comment">//1110 1111</span></span><br><span class="line">		Delay1ms(<span class="number">100</span>);</span><br><span class="line">		P2=<span class="number">0xDF</span>;<span class="comment">//1101 1111</span></span><br><span class="line">		Delay1ms(<span class="number">100</span>);</span><br><span class="line">		P2=<span class="number">0xBF</span>;<span class="comment">//1011 1111</span></span><br><span class="line">		Delay1ms(<span class="number">100</span>);</span><br><span class="line">		P2=<span class="number">0x7F</span>;<span class="comment">//0111 1111</span></span><br><span class="line">		Delay1ms(<span class="number">100</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay1ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span>		<span class="comment">//延迟函数</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line">	<span class="keyword">while</span>(xms)</span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="number">2</span>;</span><br><span class="line">		j = <span class="number">239</span>;</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span> (--j);</span><br><span class="line">		&#125; <span class="keyword">while</span> (--i);</span><br><span class="line">		xms--;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="第三章：独立按键"><a href="#第三章：独立按键" class="headerlink" title="第三章：独立按键"></a>第三章：独立按键</h2><h3 id="原理图-1"><a href="#原理图-1" class="headerlink" title="原理图"></a>原理图</h3><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106183927880.png" alt="image-20231106183927880" style="zoom:67%;" />

<h3 id="独立按键控制LED亮灭"><a href="#独立按键控制LED亮灭" class="headerlink" title="独立按键控制LED亮灭"></a>独立按键控制LED亮灭</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(P3_1==<span class="number">0</span> || P3_0==<span class="number">0</span>)	<span class="comment">//如果K1按键或K2按键按下</span></span><br><span class="line">		&#123;</span><br><span class="line">			P2_0=<span class="number">0</span>;		<span class="comment">//LED1输出0，点亮</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			P2_0=<span class="number">1</span>;		<span class="comment">//LED1输出1，熄灭</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>注意：需要一直按着按键 LED才会一直亮</li>
</ul>
<h3 id="独立按键控制LED状态"><a href="#独立按键控制LED状态" class="headerlink" title="独立按键控制LED状态"></a>独立按键控制LED状态</h3><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106185015203.png" alt="image-20231106185015203" style="zoom:50%;" />

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span>   <span class="comment">// delay函数</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line">	<span class="keyword">while</span>(xms)</span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="number">2</span>;</span><br><span class="line">		j = <span class="number">239</span>;</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span> (--j);</span><br><span class="line">		&#125; <span class="keyword">while</span> (--i);</span><br><span class="line">		xms--;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(P3_1==<span class="number">0</span>)			<span class="comment">//如果K1按键按下</span></span><br><span class="line">		&#123;</span><br><span class="line">			Delay(<span class="number">20</span>);		<span class="comment">//延时消抖</span></span><br><span class="line">			<span class="keyword">while</span>(P3_1==<span class="number">0</span>);	<span class="comment">//松手检测  如果P3_1一直等于0则代码一直处于while循环中</span></span><br><span class="line">			Delay(<span class="number">20</span>);		<span class="comment">//延时消抖</span></span><br><span class="line">			</span><br><span class="line">			P2_0=~P2_0;		<span class="comment">//LED1取反</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意 </p>
<p>while(P3_1&#x3D;&#x3D;0);</p>
<p>和</p>
<p>while(P3_1&#x3D;&#x3D;0){</p>
<p>}</p>
</blockquote>
<h3 id="独立按键控制LED显示二进制"><a href="#独立按键控制LED显示二进制" class="headerlink" title="独立按键控制LED显示二进制"></a>独立按键控制LED显示二进制</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span>  <span class="comment">//delay 函数</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line">	<span class="keyword">while</span>(xms--)</span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="number">2</span>;</span><br><span class="line">		j = <span class="number">239</span>;</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span> (--j);</span><br><span class="line">		&#125; <span class="keyword">while</span> (--i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> LEDNum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(P3_1==<span class="number">0</span>)			<span class="comment">//如果K1按键按下</span></span><br><span class="line">		&#123;</span><br><span class="line">			Delay(<span class="number">20</span>);		<span class="comment">//延时消抖</span></span><br><span class="line">			<span class="keyword">while</span>(P3_1==<span class="number">0</span>);	<span class="comment">//松手检测</span></span><br><span class="line">			Delay(<span class="number">20</span>);		<span class="comment">//延时消抖</span></span><br><span class="line">			</span><br><span class="line">			LEDNum++;		<span class="comment">//变量自增</span></span><br><span class="line">			P2=~LEDNum;		<span class="comment">//变量取反输出给LED</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="独立按键控制LED移位"><a href="#独立按键控制LED移位" class="headerlink" title="独立按键控制LED移位"></a>独立按键控制LED移位</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> LEDNum;   <span class="comment">//全局变量 默认为0</span></span><br><span class="line">                        <span class="comment">//局部变量 需要设置初始值</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	P2=~<span class="number">0x01</span>;				<span class="comment">//上电默认LED1点亮 1111 1110</span></span><br><span class="line">    </span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(P3_1==<span class="number">0</span>)			<span class="comment">//如果K1按键按下</span></span><br><span class="line">		&#123;</span><br><span class="line">			Delay(<span class="number">20</span>);</span><br><span class="line">			<span class="keyword">while</span>(P3_1==<span class="number">0</span>);</span><br><span class="line">			Delay(<span class="number">20</span>);</span><br><span class="line">			</span><br><span class="line">			LEDNum++;		<span class="comment">//LEDNum自增</span></span><br><span class="line">			<span class="keyword">if</span>(LEDNum&gt;=<span class="number">8</span>)   <span class="comment">//限制LEDNum自增范围</span></span><br><span class="line">            &#123;	</span><br><span class="line">				LEDNum=<span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">			P2=~(<span class="number">0x01</span>&lt;&lt;LEDNum);	<span class="comment">//LED的第LEDNum位点亮</span></span><br><span class="line">		&#125;</span><br><span class="line">        </span><br><span class="line">		<span class="keyword">if</span>(P3_0==<span class="number">0</span>)			<span class="comment">//如果K2按键按下</span></span><br><span class="line">		&#123;</span><br><span class="line">			Delay(<span class="number">20</span>);</span><br><span class="line">			<span class="keyword">while</span>(P3_0==<span class="number">0</span>);</span><br><span class="line">			Delay(<span class="number">20</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(LEDNum==<span class="number">0</span>)	<span class="comment">//LEDNum减到0后变为7</span></span><br><span class="line">				LEDNum=<span class="number">7</span>;</span><br><span class="line">			<span class="keyword">else</span>			<span class="comment">//LEDNum未减到0，自减</span></span><br><span class="line">				LEDNum--;</span><br><span class="line">			P2=~(<span class="number">0x01</span>&lt;&lt;LEDNum);	<span class="comment">//LED的第LEDNum位点亮</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line">	<span class="keyword">while</span>(xms--)</span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="number">2</span>;</span><br><span class="line">		j = <span class="number">239</span>;</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span> (--j);</span><br><span class="line">		&#125; <span class="keyword">while</span> (--i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>按下P3_0左移</li>
<li>按下P3_0右移</li>
</ul>
<h2 id="第四章：数码管"><a href="#第四章：数码管" class="headerlink" title="第四章：数码管"></a>第四章：数码管</h2><h3 id="原理图-2"><a href="#原理图-2" class="headerlink" title="原理图"></a>原理图</h3><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106191647973.png" alt="image-20231106191647973"  />

<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106192120556.png" alt="image-20231106192120556"></p>
<ul>
<li>本开发板使用共阴极连接</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106193327684.png" alt="image-20231106193327684" style="zoom:50%;" />

<ul>
<li><p>使用译码器实现位选：选择哪个数码管亮</p>
</li>
<li><p>74LS138译码器</p>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106192935212.png" alt="image-20231106192935212" style="zoom:50%;" />
</li>
<li><p>输入端 A B C</p>
</li>
<li><p>使能端 G1 G2! G3! </p>
</li>
<li><p>输出端  Y!</p>
</li>
</ul>
<p><strong>真值表</strong></p>
<table>
<thead>
<tr>
<th align="center">C</th>
<th align="center">B</th>
<th align="center">A</th>
<th align="center">输出</th>
<th align="center">Y的脚标</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0111 1111</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1011 1111</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1101 1111</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1110 1111</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1111 0111</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1111 1011</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1111 1101</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1111 1110</td>
<td align="center">7</td>
</tr>
</tbody></table>
<ul>
<li><p>使用收发器（或锁存器）实现段选：控制数码管怎么亮</p>
</li>
<li><p>74HC245 收发器</p>
</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106194539340.png" alt="image-20231106194539340" style="zoom:50%;" />



<ul>
<li><p>使能端  OE!</p>
</li>
<li><p>选择端   DIR  接高电平左边的数据送到右边 </p>
<p>​                       接低电平右边的数据送到左边</p>
</li>
</ul>
<blockquote>
<p><em>74hc245是</em>八同相三态收发器,数据可双向传送.</p>
<p>74c573是8位三态<em>锁存器</em>,有锁存数据功能.数据单向传送.</p>
<p>两种芯片都有三态,都能起缓冲作用.</p>
</blockquote>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106211237119.png" alt="image-20231106211237119" style="zoom:50%;" />



<h3 id="静态数码管显示"><a href="#静态数码管显示" class="headerlink" title="静态数码管显示"></a>静态数码管显示</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//数码管段码表</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Table[]=&#123;<span class="number">0x3F</span>,<span class="number">0x06</span>,<span class="number">0x5B</span>,<span class="number">0x4F</span>,<span class="number">0x66</span>,<span class="number">0x6D</span>,<span class="number">0x7D</span>,<span class="number">0x07</span>,<span class="number">0x7F</span>,<span class="number">0x6F</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//数码管显示子函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">show</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Location,Number)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">switch</span>(Location)		<span class="comment">//位码输出</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>:P2_4=<span class="number">1</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:P2_4=<span class="number">1</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:P2_4=<span class="number">1</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:P2_4=<span class="number">1</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">5</span>:P2_4=<span class="number">0</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">6</span>:P2_4=<span class="number">0</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">7</span>:P2_4=<span class="number">0</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">8</span>:P2_4=<span class="number">0</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	P0=Table[Number];	<span class="comment">//段码输出</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	show(<span class="number">2</span>,<span class="number">3</span>);	<span class="comment">//在数码管的第2位置显示3</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">顺着数第n个数码管</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
<th align="center">7</th>
<th align="center">8</th>
</tr>
</thead>
<tbody><tr>
<td align="center">LED编号（原理图）</td>
<td align="center">8</td>
<td align="center">7</td>
<td align="center">6</td>
<td align="center">5</td>
<td align="center">4</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">Y（脚标）</td>
<td align="center">7</td>
<td align="center">6</td>
<td align="center">5</td>
<td align="center">4</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">C B A</td>
<td align="center">111</td>
<td align="center">110</td>
<td align="center">101</td>
<td align="center">100</td>
<td align="center">011</td>
<td align="center">010</td>
<td align="center">001</td>
<td align="center">000</td>
</tr>
</tbody></table>
<h3 id="动态数码管显示"><a href="#动态数码管显示" class="headerlink" title="动态数码管显示"></a>动态数码管显示</h3><ul>
<li>段选的清零：消影</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//数码管段码表</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Table[]=&#123;<span class="number">0x3F</span>,<span class="number">0x06</span>,<span class="number">0x5B</span>,<span class="number">0x4F</span>,<span class="number">0x66</span>,<span class="number">0x6D</span>,<span class="number">0x7D</span>,<span class="number">0x07</span>,<span class="number">0x7F</span>,<span class="number">0x6F</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span>  <span class="comment">//延时子函数</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line">	<span class="keyword">while</span>(xms--)</span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="number">2</span>;</span><br><span class="line">		j = <span class="number">239</span>;</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span> (--j);</span><br><span class="line">		&#125; <span class="keyword">while</span> (--i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//数码管显示子函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">show</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Location,Number)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">switch</span>(Location)		<span class="comment">//位码输出</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>:P2_4=<span class="number">1</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:P2_4=<span class="number">1</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:P2_4=<span class="number">1</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:P2_4=<span class="number">1</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">5</span>:P2_4=<span class="number">0</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">6</span>:P2_4=<span class="number">0</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">7</span>:P2_4=<span class="number">0</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">8</span>:P2_4=<span class="number">0</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	P0=Table[Number];	    <span class="comment">//段码输出</span></span><br><span class="line">	Delay(<span class="number">1</span>);				<span class="comment">//显示一段时间</span></span><br><span class="line">	P0=<span class="number">0x00</span>;				<span class="comment">//段码清0，消影</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		show(<span class="number">1</span>,<span class="number">1</span>);		<span class="comment">//在数码管的第1位置显示1</span></span><br><span class="line"><span class="comment">//		Delay(20);</span></span><br><span class="line">		show(<span class="number">2</span>,<span class="number">2</span>);		<span class="comment">//在数码管的第2位置显示2</span></span><br><span class="line"><span class="comment">//		Delay(20);</span></span><br><span class="line">		show(<span class="number">3</span>,<span class="number">3</span>);		<span class="comment">//在数码管的第3位置显示3</span></span><br><span class="line"><span class="comment">//		Delay(20);</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="第五章：LCD1602调试"><a href="#第五章：LCD1602调试" class="headerlink" title="第五章：LCD1602调试"></a>第五章：LCD1602调试</h2><ul>
<li>LCD1602为液晶屏</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231106220518747.png" alt="image-20231106220518747"></p>
<ul>
<li>把已经写好的LCD1602.c 和 .h文件导入项目文件</li>
<li>使用前 需要先初始化</li>
</ul>
<h2 id="第六章：矩阵键盘"><a href="#第六章：矩阵键盘" class="headerlink" title="第六章：矩阵键盘"></a>第六章：矩阵键盘</h2><h3 id="原理图-3"><a href="#原理图-3" class="headerlink" title="原理图"></a>原理图</h3><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231116221307347.png" alt="image-20231116221307347" style="zoom:50%;" />

<p>矩阵键盘扫描</p>
<h3 id="矩阵键盘1"><a href="#矩阵键盘1" class="headerlink" title="矩阵键盘1"></a>矩阵键盘1</h3><p>把delay和lcd1602的.c 和.h文件导入</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span>		<span class="comment">//包含Delay头文件</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LCD1602.h&quot;</span>	<span class="comment">//包含LCD1602头文件</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;MatrixKey.h&quot;</span>	<span class="comment">//包含矩阵键盘头文件</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> KeyNum;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LCD_Init();							<span class="comment">//LCD初始化</span></span><br><span class="line">	LCD_ShowString(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&quot;MatrixKey:&quot;</span>);	<span class="comment">//LCD显示字符串</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		KeyNum=MatrixKey();				<span class="comment">//获取矩阵键盘键码</span></span><br><span class="line">		<span class="keyword">if</span>(KeyNum)						<span class="comment">//如果有按键按下</span></span><br><span class="line">		&#123;</span><br><span class="line">			LCD_ShowNum(<span class="number">2</span>,<span class="number">1</span>,KeyNum,<span class="number">2</span>);	<span class="comment">//LCD显示键码</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  矩阵键盘读取按键键码</span></span><br><span class="line"><span class="comment">  * @param  无</span></span><br><span class="line"><span class="comment">  * @retval KeyNumber 按下按键的键码值</span></span><br><span class="line"><span class="comment">			如果按键按下不放，程序会停留在此函数，松手的一瞬间，返回按键键码，没有按键按下时，返回0</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//@brief  简介</span></span><br><span class="line"><span class="comment">//@param  传入参数</span></span><br><span class="line"><span class="comment">//@retval 返回值</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">MatrixKey</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> KeyNumber=<span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	P1=<span class="number">0xFF</span>; <span class="comment">//把p1口全部置高电平</span></span><br><span class="line">	P1_3=<span class="number">0</span>;  <span class="comment">//扫描第一列</span></span><br><span class="line">	<span class="keyword">if</span>(P1_7==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_7==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">1</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_6==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_6==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">5</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_5==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_5==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">9</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_4==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_4==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">13</span>;&#125;</span><br><span class="line">	<span class="comment">//注意消抖</span></span><br><span class="line">    </span><br><span class="line">	P1=<span class="number">0xFF</span>;</span><br><span class="line">	P1_2=<span class="number">0</span>;  <span class="comment">//扫描第二列</span></span><br><span class="line">	<span class="keyword">if</span>(P1_7==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_7==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">2</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_6==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_6==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">6</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_5==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_5==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">10</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_4==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_4==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">14</span>;&#125;</span><br><span class="line">	</span><br><span class="line">	P1=<span class="number">0xFF</span>;</span><br><span class="line">	P1_1=<span class="number">0</span>;  <span class="comment">//扫描第三列</span></span><br><span class="line">	<span class="keyword">if</span>(P1_7==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_7==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">3</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_6==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_6==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">7</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_5==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_5==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">11</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_4==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_4==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">15</span>;&#125;</span><br><span class="line">	</span><br><span class="line">	P1=<span class="number">0xFF</span>;</span><br><span class="line">	P1_0=<span class="number">0</span>;  <span class="comment">//扫描第四列</span></span><br><span class="line">	<span class="keyword">if</span>(P1_7==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_7==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">4</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_6==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_6==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">8</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_5==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_5==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">12</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_4==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_4==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">16</span>;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> KeyNumber;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __MATRIXKEY_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __MATRIXKEY_H__</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">MatrixKey</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="矩阵键盘密码锁"><a href="#矩阵键盘密码锁" class="headerlink" title="矩阵键盘密码锁"></a>矩阵键盘密码锁</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span>  </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LCD1602.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;MatrixKey.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> KeyNum;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> Password,Count;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LCD_Init();</span><br><span class="line">	LCD_ShowString(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&quot;Password:&quot;</span>);</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		KeyNum=MatrixKey();</span><br><span class="line">		<span class="keyword">if</span>(KeyNum)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(KeyNum&lt;=<span class="number">10</span>)	<span class="comment">//如果S1~S10按键按下，输入密码</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>(Count&lt;<span class="number">4</span>)	<span class="comment">//如果输入次数小于4</span></span><br><span class="line">				&#123;</span><br><span class="line">					Password*=<span class="number">10</span>;				<span class="comment">//密码左移一位</span></span><br><span class="line">					Password+=KeyNum%<span class="number">10</span>;		<span class="comment">//获取一位密码</span></span><br><span class="line">					Count++;	<span class="comment">//计次加一</span></span><br><span class="line">				&#125;</span><br><span class="line">				LCD_ShowNum(<span class="number">2</span>,<span class="number">1</span>,Password,<span class="number">4</span>);	<span class="comment">//更新显示</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(KeyNum==<span class="number">11</span>)	<span class="comment">//如果S11按键按下，确认</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>(Password==<span class="number">2345</span>)	<span class="comment">//如果密码等于正确密码</span></span><br><span class="line">				&#123;</span><br><span class="line">					LCD_ShowString(<span class="number">1</span>,<span class="number">14</span>,<span class="string">&quot;OK &quot;</span>);	<span class="comment">//显示OK</span></span><br><span class="line">					Password=<span class="number">0</span>;		<span class="comment">//密码清零</span></span><br><span class="line">					Count=<span class="number">0</span>;		<span class="comment">//计次清零</span></span><br><span class="line">					LCD_ShowNum(<span class="number">2</span>,<span class="number">1</span>,Password,<span class="number">4</span>);	<span class="comment">//更新显示</span></span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span>				<span class="comment">//否则</span></span><br><span class="line">				&#123;</span><br><span class="line">					LCD_ShowString(<span class="number">1</span>,<span class="number">14</span>,<span class="string">&quot;ERR&quot;</span>);	<span class="comment">//显示ERR</span></span><br><span class="line">					Password=<span class="number">0</span>;		<span class="comment">//密码清零</span></span><br><span class="line">					Count=<span class="number">0</span>;		<span class="comment">//计次清零</span></span><br><span class="line">					LCD_ShowNum(<span class="number">2</span>,<span class="number">1</span>,Password,<span class="number">4</span>);	<span class="comment">//更新显示</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(KeyNum==<span class="number">12</span>)	<span class="comment">//如果S12按键按下，取消</span></span><br><span class="line">			&#123;</span><br><span class="line">				Password=<span class="number">0</span>;		<span class="comment">//密码清零</span></span><br><span class="line">				Count=<span class="number">0</span>;		<span class="comment">//计次清零</span></span><br><span class="line">				LCD_ShowNum(<span class="number">2</span>,<span class="number">1</span>,Password,<span class="number">4</span>);	<span class="comment">//更新显示</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="第七章：定时器"><a href="#第七章：定时器" class="headerlink" title="第七章：定时器"></a>第七章：定时器</h2><h3 id="定时器的使用"><a href="#定时器的使用" class="headerlink" title="定时器的使用"></a>定时器的使用</h3><h3 id="按键控制LCD流水灯模式"><a href="#按键控制LCD流水灯模式" class="headerlink" title="按键控制LCD流水灯模式"></a>按键控制LCD流水灯模式</h3><p>计时器函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  定时器0初始化，1毫秒@12.000MHz</span></span><br><span class="line"><span class="comment">  * @param  无</span></span><br><span class="line"><span class="comment">  * @retval 无</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Timer0Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	TMOD =TMOD &amp;<span class="number">0xF0</span>;		<span class="comment">//设置定时器模式，让TMOD的低四位清零，高四位不变</span></span><br><span class="line">	TMOD =TMOD |<span class="number">0x01</span>;		<span class="comment">//设置定时器模式，让TMOD的最低位置一</span></span><br><span class="line">	TL0 = <span class="number">0x18</span>;		<span class="comment">//设置定时初值  64535/256</span></span><br><span class="line">	TH0 = <span class="number">0xFC</span>;		<span class="comment">//设置定时初值  64535%256</span></span><br><span class="line">	TF0 = <span class="number">0</span>;		<span class="comment">//清除TF0标志</span></span><br><span class="line">	TR0 = <span class="number">1</span>;		<span class="comment">//定时器0开始计时</span></span><br><span class="line">	ET0=<span class="number">1</span>;          <span class="comment">//开计时器中断</span></span><br><span class="line">	EA=<span class="number">1</span>;         <span class="comment">//开总中断</span></span><br><span class="line">	PT0=<span class="number">0</span>;       <span class="comment">//默认为零</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*定时器中断函数模板</span></span><br><span class="line"><span class="comment">void Timer0_Routine() interrupt 1</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">	static unsigned int T0Count;</span></span><br><span class="line"><span class="comment">	//</span></span><br><span class="line"><span class="comment">	TL0 = 0x18;		//设置定时初值</span></span><br><span class="line"><span class="comment">	TH0 = 0xFC;		//设置定时初值</span></span><br><span class="line"><span class="comment">	T0Count++;</span></span><br><span class="line"><span class="comment">	if(T0Count&gt;=1000)</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		T0Count=0;</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  获取独立按键键码</span></span><br><span class="line"><span class="comment">  * @param  无</span></span><br><span class="line"><span class="comment">  * @retval 按下按键的键码，范围：0~4，无按键按下时返回值为0</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">Key</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> KeyNumber=<span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(P3_1==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P3_1==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">1</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P3_0==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P3_0==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">2</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P3_2==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P3_2==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">3</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P3_3==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P3_3==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">4</span>;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> KeyNumber;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer0.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Key.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;INTRINS.H&gt;</span>   <span class="comment">//包含_crol_()的库 循环左移</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> KeyNum,LEDMode;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	P2=<span class="number">0xFE</span>;</span><br><span class="line">	Timer0Init();</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		KeyNum=Key();		<span class="comment">//获取独立按键键码</span></span><br><span class="line">		<span class="keyword">if</span>(KeyNum)			<span class="comment">//如果按键按下</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(KeyNum==<span class="number">1</span>)	<span class="comment">//如果K1按键按下</span></span><br><span class="line">			&#123;</span><br><span class="line">				LEDMode++;	<span class="comment">//模式切换</span></span><br><span class="line">				<span class="keyword">if</span>(LEDMode&gt;=<span class="number">2</span>)LEDMode=<span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Timer0_Routine</span><span class="params">()</span> interrupt 1</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">int</span> T0Count;</span><br><span class="line">	TL0 = <span class="number">0x18</span>;		<span class="comment">//设置定时初值</span></span><br><span class="line">	TH0 = <span class="number">0xFC</span>;		<span class="comment">//设置定时初值</span></span><br><span class="line">	T0Count++;		<span class="comment">//T0Count计次，对中断频率进行分频</span></span><br><span class="line">	<span class="keyword">if</span>(T0Count&gt;=<span class="number">500</span>)<span class="comment">//分频500次，500ms</span></span><br><span class="line">	&#123;</span><br><span class="line">		T0Count=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(LEDMode==<span class="number">0</span>)			<span class="comment">//模式判断</span></span><br><span class="line">			P2=_crol_(P2,<span class="number">1</span>);	<span class="comment">//LED输出</span></span><br><span class="line">		<span class="keyword">if</span>(LEDMode==<span class="number">1</span>)</span><br><span class="line">			P2=_cror_(P2,<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="定时器时钟"><a href="#定时器时钟" class="headerlink" title="定时器时钟"></a>定时器时钟</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LCD1602.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer0.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Sec=<span class="number">55</span>,Min=<span class="number">59</span>,Hour=<span class="number">23</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LCD_Init();</span><br><span class="line">	Timer0Init();</span><br><span class="line">	</span><br><span class="line">	LCD_ShowString(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&quot;Clock:&quot;</span>);	<span class="comment">//上电显示静态字符串</span></span><br><span class="line">	LCD_ShowString(<span class="number">2</span>,<span class="number">1</span>,<span class="string">&quot;  :  :&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		LCD_ShowNum(<span class="number">2</span>,<span class="number">1</span>,Hour,<span class="number">2</span>);	<span class="comment">//显示时分秒</span></span><br><span class="line">		LCD_ShowNum(<span class="number">2</span>,<span class="number">4</span>,Min,<span class="number">2</span>);</span><br><span class="line">		LCD_ShowNum(<span class="number">2</span>,<span class="number">7</span>,Sec,<span class="number">2</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Timer0_Routine</span><span class="params">()</span> interrupt 1</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">int</span> T0Count;</span><br><span class="line">	TL0 = <span class="number">0x18</span>;		<span class="comment">//设置定时初值</span></span><br><span class="line">	TH0 = <span class="number">0xFC</span>;		<span class="comment">//设置定时初值</span></span><br><span class="line">	T0Count++;</span><br><span class="line">	<span class="keyword">if</span>(T0Count&gt;=<span class="number">1000</span>)	<span class="comment">//定时器分频，1s</span></span><br><span class="line">	&#123;</span><br><span class="line">		T0Count=<span class="number">0</span>;</span><br><span class="line">		Sec++;			<span class="comment">//1秒到，Sec自增</span></span><br><span class="line">		<span class="keyword">if</span>(Sec&gt;=<span class="number">60</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			Sec=<span class="number">0</span>;		<span class="comment">//60秒到，Sec清0，Min自增</span></span><br><span class="line">			Min++;</span><br><span class="line">			<span class="keyword">if</span>(Min&gt;=<span class="number">60</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				Min=<span class="number">0</span>;	<span class="comment">//60分钟到，Min清0，Hour自增</span></span><br><span class="line">				Hour++;</span><br><span class="line">				<span class="keyword">if</span>(Hour&gt;=<span class="number">24</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					Hour=<span class="number">0</span>;	<span class="comment">//24小时到，Hour清0</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="第八章：串口"><a href="#第八章：串口" class="headerlink" title="第八章：串口"></a>第八章：串口</h2><h3 id="串口通讯"><a href="#串口通讯" class="headerlink" title="串口通讯"></a>串口通讯</h3><p>STC—ISP 串口助手的串口号需要 保持一致</p>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118163512283.png" alt="image-20231118163512283" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118163842151.png" alt="image-20231118163842151" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118164244096.png" alt="image-20231118164244096" style="zoom:50%;" />

<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118164506057.png" alt="image-20231118164506057"></p>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118164734500.png" alt="image-20231118164734500" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118165011098.png" alt="image-20231118165011098" style="zoom:50%;" />

<h3 id="串口向电脑发送数据"><a href="#串口向电脑发送数据" class="headerlink" title="串口向电脑发送数据"></a>串口向电脑发送数据</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UART.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Sec;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	UART_Init();			<span class="comment">//串口初始化</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		UART_SendByte(Sec);	<span class="comment">//串口发送一个字节</span></span><br><span class="line">		Sec++;				<span class="comment">//Sec自增</span></span><br><span class="line">		Delay(<span class="number">1000</span>);		<span class="comment">//延时1秒</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  串口初始化，4800bps@12.000MHz</span></span><br><span class="line"><span class="comment">  * @param  无</span></span><br><span class="line"><span class="comment">  * @retval 无</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">UART_Init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	SCON=<span class="number">0x40</span>;</span><br><span class="line">	PCON |= <span class="number">0x80</span>;   <span class="comment">//PCON=0</span></span><br><span class="line">	TMOD &amp;= <span class="number">0x0F</span>;		<span class="comment">//设置定时器模式</span></span><br><span class="line">	TMOD |= <span class="number">0x20</span>;		<span class="comment">//设置定时器模式</span></span><br><span class="line">	TL1 = <span class="number">0xF3</span>;		<span class="comment">//设定定时初值</span></span><br><span class="line">	TH1 = <span class="number">0xF3</span>;		<span class="comment">//设定定时器重装值</span></span><br><span class="line">	ET1 = <span class="number">0</span>;		<span class="comment">//禁止定时器1中断</span></span><br><span class="line">	TR1 = <span class="number">1</span>;		<span class="comment">//启动定时器1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  串口发送一个字节数据</span></span><br><span class="line"><span class="comment">  * @param  Byte 要发送的一个字节数据</span></span><br><span class="line"><span class="comment">  * @retval 无</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">UART_SendByte</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Byte)</span></span><br><span class="line">&#123;</span><br><span class="line">	SBUF=Byte;</span><br><span class="line">	<span class="keyword">while</span>(TI==<span class="number">0</span>);</span><br><span class="line">	TI=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="电脑通过串口控制LED"><a href="#电脑通过串口控制LED" class="headerlink" title="电脑通过串口控制LED"></a>电脑通过串口控制LED</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UART.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	UART_Init();		<span class="comment">//串口初始化</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">UART_Routine</span><span class="params">()</span> interrupt 4</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(RI==<span class="number">1</span>)					<span class="comment">//如果接收标志位为1，接收到了数据</span></span><br><span class="line">	&#123;</span><br><span class="line">		P2=~SBUF;				<span class="comment">//读取数据，取反后输出到LED</span></span><br><span class="line">		UART_SendByte(SBUF);	<span class="comment">//将受到的数据发回串口</span></span><br><span class="line">		RI=<span class="number">0</span>;					<span class="comment">//接收标志位清0</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  串口初始化，4800bps@12.000MHz</span></span><br><span class="line"><span class="comment">  * @param  无</span></span><br><span class="line"><span class="comment">  * @retval 无</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">UART_Init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	SCON=<span class="number">0x50</span>;</span><br><span class="line">	PCON |= <span class="number">0x80</span>;</span><br><span class="line">	TMOD &amp;= <span class="number">0x0F</span>;		<span class="comment">//设置定时器模式</span></span><br><span class="line">	TMOD |= <span class="number">0x20</span>;		<span class="comment">//设置定时器模式</span></span><br><span class="line">	TL1 = <span class="number">0xF3</span>;		<span class="comment">//设定定时初值</span></span><br><span class="line">	TH1 = <span class="number">0xF3</span>;		<span class="comment">//设定定时器重装值</span></span><br><span class="line">	ET1 = <span class="number">0</span>;		<span class="comment">//禁止定时器1中断</span></span><br><span class="line">	TR1 = <span class="number">1</span>;		<span class="comment">//启动定时器1</span></span><br><span class="line">	EA=<span class="number">1</span>;</span><br><span class="line">	ES=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  串口发送一个字节数据</span></span><br><span class="line"><span class="comment">  * @param  Byte 要发送的一个字节数据</span></span><br><span class="line"><span class="comment">  * @retval 无</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">UART_SendByte</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Byte)</span></span><br><span class="line">&#123;</span><br><span class="line">	SBUF=Byte;</span><br><span class="line">	<span class="keyword">while</span>(TI==<span class="number">0</span>);</span><br><span class="line">	TI=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*串口中断函数模板</span></span><br><span class="line"><span class="comment">void UART_Routine() interrupt 4</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">	if(RI==1)</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		RI=0;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="第九章：LED点阵屏"><a href="#第九章：LED点阵屏" class="headerlink" title="第九章：LED点阵屏"></a>第九章：LED点阵屏</h2><h3 id="点阵屏原理"><a href="#点阵屏原理" class="headerlink" title="点阵屏原理"></a>点阵屏原理</h3><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118183438645.png" alt="image-20231118183438645" style="zoom:50%;" />



<p>行：通过p0 口直接赋</p>
<p>列：通过74HC595 间接赋</p>
<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118183545889.png" alt="image-20231118183545889" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118183733337.png" alt="image-20231118183733337" style="zoom:50%;" />













<img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118183818544.png" alt="image-20231118183818544" style="zoom:50%;" />

<h3 id="LED点阵屏显示图形"><a href="#LED点阵屏显示图形" class="headerlink" title="LED点阵屏显示图形"></a>LED点阵屏显示图形</h3><p>普中的板子要把数码管右边的橡皮帽插左边两根上  不然不会亮</p>
<p>找到 J24 跳线帽，短接到GND那一端。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">sbit RCK=P3^<span class="number">5</span>;		<span class="comment">//RCLK</span></span><br><span class="line">sbit SCK=P3^<span class="number">6</span>;		<span class="comment">//SRCLK</span></span><br><span class="line">sbit SER=P3^<span class="number">4</span>;		<span class="comment">//SER</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MATRIX_LED_PORT		P0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  74HC595写入一个字节</span></span><br><span class="line"><span class="comment">  * @param  Byte 要写入的字节 0000 0000</span></span><br><span class="line"><span class="comment">  * @retval 无</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">void</span> _74HC595_WriteByte(<span class="type">unsigned</span> <span class="type">char</span> Byte)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		SER=Byte&amp;(<span class="number">0x80</span>&gt;&gt;i);    <span class="comment">// SER=Byte&amp;0x80</span></span><br><span class="line">		SCK=<span class="number">1</span>;               <span class="comment">//上升沿  下移</span></span><br><span class="line">		SCK=<span class="number">0</span>;              <span class="comment">//清零</span></span><br><span class="line">	&#125;</span><br><span class="line">	RCK=<span class="number">1</span>;                     <span class="comment">//送到寄存器</span></span><br><span class="line">	RCK=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  LED点阵屏显示一列数据</span></span><br><span class="line"><span class="comment">  * @param  Column 要选择的列，范围：0~7，0在最左边</span></span><br><span class="line"><span class="comment">  * @param  Data 选择列显示的数据，高位在上，1为亮，0为灭</span></span><br><span class="line"><span class="comment">  * @retval 无</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="comment">// 0x80 1000 0000</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">MatrixLED_ShowColumn</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Column,Data)</span></span><br><span class="line">&#123;</span><br><span class="line">	_74HC595_WriteByte(Data); <span class="comment">//段选</span></span><br><span class="line">	MATRIX_LED_PORT=~(<span class="number">0x80</span>&gt;&gt;Column); <span class="comment">//位选</span></span><br><span class="line">	Delay(<span class="number">1</span>);   </span><br><span class="line">	MATRIX_LED_PORT=<span class="number">0xFF</span>;    <span class="comment">//位选清零 消影</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	SCK=<span class="number">0</span>;</span><br><span class="line">	RCK=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		MatrixLED_ShowColumn(<span class="number">0</span>,<span class="number">0x3C</span>);  <span class="comment">//0011 1100</span></span><br><span class="line">		MatrixLED_ShowColumn(<span class="number">1</span>,<span class="number">0x42</span>);</span><br><span class="line">		MatrixLED_ShowColumn(<span class="number">2</span>,<span class="number">0xA9</span>);</span><br><span class="line">		MatrixLED_ShowColumn(<span class="number">3</span>,<span class="number">0x85</span>);</span><br><span class="line">		MatrixLED_ShowColumn(<span class="number">4</span>,<span class="number">0x85</span>);</span><br><span class="line">		MatrixLED_ShowColumn(<span class="number">5</span>,<span class="number">0xA9</span>);</span><br><span class="line">		MatrixLED_ShowColumn(<span class="number">6</span>,<span class="number">0x42</span>);</span><br><span class="line">		MatrixLED_ShowColumn(<span class="number">7</span>,<span class="number">0x3C</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118201814045.png" alt="image-20231118201814045"></p>
<h3 id="LED点阵屏显示动画"><a href="#LED点阵屏显示动画" class="headerlink" title="LED点阵屏显示动画"></a>LED点阵屏显示动画</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;MatrixLED.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//动画数据(软件生成)</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code Animation[]=&#123;</span><br><span class="line">	<span class="number">0x3C</span>,<span class="number">0x42</span>,<span class="number">0xA9</span>,<span class="number">0x85</span>,<span class="number">0x85</span>,<span class="number">0xA9</span>,<span class="number">0x42</span>,<span class="number">0x3C</span>,</span><br><span class="line">	<span class="number">0x3C</span>,<span class="number">0x42</span>,<span class="number">0xA1</span>,<span class="number">0x85</span>,<span class="number">0x85</span>,<span class="number">0xA1</span>,<span class="number">0x42</span>,<span class="number">0x3C</span>,</span><br><span class="line">	<span class="number">0x3C</span>,<span class="number">0x42</span>,<span class="number">0xA5</span>,<span class="number">0x89</span>,<span class="number">0x89</span>,<span class="number">0xA5</span>,<span class="number">0x42</span>,<span class="number">0x3C</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i,Offset=<span class="number">0</span>,Count=<span class="number">0</span>;</span><br><span class="line">	MatrixLED_Init();   <span class="comment">//初始化</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)	<span class="comment">//循环8次，显示8列数据</span></span><br><span class="line">		&#123;</span><br><span class="line">			MatrixLED_ShowColumn(i,Animation[i+Offset]);</span><br><span class="line">		&#125;</span><br><span class="line">		Count++;			<span class="comment">//计次延时</span></span><br><span class="line">		<span class="keyword">if</span>(Count&gt;<span class="number">15</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			Count=<span class="number">0</span>;</span><br><span class="line">			Offset+=<span class="number">8</span>;		<span class="comment">//偏移+8，切换下一帧画面</span></span><br><span class="line">			<span class="keyword">if</span>(Offset&gt;<span class="number">16</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				Offset=<span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">sbit RCK=P3^<span class="number">5</span>;		<span class="comment">//RCLK</span></span><br><span class="line">sbit SCK=P3^<span class="number">6</span>;		<span class="comment">//SRCLK</span></span><br><span class="line">sbit SER=P3^<span class="number">4</span>;		<span class="comment">//SER</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MATRIX_LED_PORT		P0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  74HC595写入一个字节</span></span><br><span class="line"><span class="comment">  * @param  Byte 要写入的字节</span></span><br><span class="line"><span class="comment">  * @retval 无</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">void</span> _74HC595_WriteByte(<span class="type">unsigned</span> <span class="type">char</span> Byte)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		SER=Byte&amp;(<span class="number">0x80</span>&gt;&gt;i);</span><br><span class="line">		SCK=<span class="number">1</span>;</span><br><span class="line">		SCK=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	RCK=<span class="number">1</span>;</span><br><span class="line">	RCK=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  点阵屏初始化</span></span><br><span class="line"><span class="comment">  * @param  无</span></span><br><span class="line"><span class="comment">  * @retval 无</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">MatrixLED_Init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	SCK=<span class="number">0</span>;</span><br><span class="line">	RCK=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @brief  LED点阵屏显示一列数据</span></span><br><span class="line"><span class="comment">  * @param  Column 要选择的列，范围：0~7，0在最左边</span></span><br><span class="line"><span class="comment">  * @param  Data 选择列显示的数据，高位在上，1为亮，0为灭</span></span><br><span class="line"><span class="comment">  * @retval 无</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">MatrixLED_ShowColumn</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Column,Data)</span></span><br><span class="line">&#123;</span><br><span class="line">	_74HC595_WriteByte(Data);</span><br><span class="line">	MATRIX_LED_PORT=~(<span class="number">0x80</span>&gt;&gt;Column);</span><br><span class="line">	Delay(<span class="number">1</span>);</span><br><span class="line">	MATRIX_LED_PORT=<span class="number">0xFF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="第十章：DS1302时钟"><a href="#第十章：DS1302时钟" class="headerlink" title="第十章：DS1302时钟"></a>第十章：DS1302时钟</h2><h3 id="DS1302"><a href="#DS1302" class="headerlink" title="DS1302"></a>DS1302</h3><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20231118220728807.png" alt="image-20231118220728807" style="zoom:50%;" />



<p>第十一章:蜂鸣器</p>
<p>第十二章：AT24C02</p>
<p>第十三章：DS18B20</p>
<p>第十四章：LCD1602</p>
<p>第十五章：直流电机驱动（PWM）</p>
<p>第十六章：AD&#x2F;DA</p>
<p>第十七章：红外遥控</p>
<h1 id="蓝桥杯"><a href="#蓝桥杯" class="headerlink" title="蓝桥杯"></a>蓝桥杯</h1><h2 id="定时器-interrupt"><a href="#定时器-interrupt" class="headerlink" title="定时器 interrupt"></a>定时器 interrupt</h2><p>定时器 0                               interrupt1</p>
<p>定时器1                                interrupt3</p>
<p>定时器2                                 interrupt12</p>
<p>串口服务    Uart1Server()  interrupt 4</p>
<p>i++  返回 i </p>
<p>++i  返回 i+1 </p>
<p>unsigned char 0-255</p>
<p>unsigned int 0-65535 </p>
<p>flot 小数</p>
<p>bit 0或1</p>
<h2 id="注意-int-和-char-的取值范围-！！！！"><a href="#注意-int-和-char-的取值范围-！！！！" class="headerlink" title="注意 int 和 char 的取值范围 ！！！！"></a>注意 int 和 char 的取值范围 ！！！！</h2><p>与 &amp;   同1为1  否则为0</p>
<p>或 | 有1为1   全0为0</p>
<h2 id="取数相乘时，注意取值范围"><a href="#取数相乘时，注意取值范围" class="headerlink" title="取数相乘时，注意取值范围"></a>取数相乘时，注意取值范围</h2><p>&#x2F;10 %10   取 十位 </p>
<p>%10          取个位  </p>
<p>数码管 0 -&gt;亮</p>
<pre><code>switch (Key_Down)
&#123;
    case :
    
    break;
&#125;
</code></pre>
<p>跳线帽</p>
<p>左边 矩阵按键  KBD</p>
<p>右边  独立按键 BTN</p>
<h3 id="设定的温度参数在退出参数设置界面时生效"><a href="#设定的温度参数在退出参数设置界面时生效" class="headerlink" title="设定的温度参数在退出参数设置界面时生效"></a>设定的温度参数在退出参数设置界面时生效</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">if</span>(Seg_Disp_Mode == <span class="number">1</span>) <span class="comment">//当前处于温度参数设置界面</span></span><br><span class="line">		Temperature_Params = Temperature_Params_Ctrol;</span><br><span class="line"><span class="comment">//将实际控制数据赋值给设置变量 便于数据更改</span></span><br><span class="line">	<span class="keyword">if</span>(Seg_Disp_Mode == <span class="number">2</span>) <span class="comment">//当界面从参数设置切换出去后</span></span><br><span class="line">		Temperature_Params_Ctrol = Temperature_Params;</span><br><span class="line"><span class="comment">//将设置数据保存到控制变量</span></span><br></pre></td></tr></table></figure>



<p>设置 默认时 ，除了定义时index &#x3D; 1，还要在程序内把index &#x3D; 1</p>
<p>设置：006000前面的 0 数码管 熄灭</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i=<span class="number">3</span>;  <span class="comment">//从第三个数码管开始</span></span><br><span class="line"><span class="keyword">while</span>(Seg_Buf[i] == <span class="number">0</span>) </span><br><span class="line">	&#123;</span><br><span class="line">		Seg_Buf[i] = <span class="number">10</span>;  <span class="comment">//数码管熄灭</span></span><br><span class="line">		i=i+<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">7</span>) <span class="keyword">break</span>; <span class="comment">//保证最低位不熄灭 避免程序卡死</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<p>led和seg的 全部熄灭，显示功能，可以，在中断里面写</p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>有大小温度时 ：设置一个数组，在设置一个变量给数组下标，选择  切换</p>
<p>设置温度时 ，改变数值下标即可</p>
<h3 id="在seg的显示界面"><a href="#在seg的显示界面" class="headerlink" title="在seg的显示界面"></a>在seg的显示界面</h3><h4 id="1-数据显示"><a href="#1-数据显示" class="headerlink" title="1. 数据显示"></a>1. 数据显示</h4><p>  每次从数据界面切换到参数界面，默认选择min </p>
<p>  注意 在 此时设置</p>
<h4 id="2-参数设置"><a href="#2-参数设置" class="headerlink" title="2.参数设置"></a>2.参数设置</h4><p>注意 强制类型转换</p>
<h2 id="界面切换"><a href="#界面切换" class="headerlink" title="界面切换"></a>界面切换</h2><p>进入参数设置  时  给disp 赋值</p>
<p>进入数据显示 时   给conl赋值  注意赋值前 判断 min 和 max 是否合理 </p>
<p><strong>加 减</strong> ：改变的是 disp 值 </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在 key 的 模式 切换 switch 下</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (show_mode == <span class="number">1</span>) <span class="comment">// 进入参数设置</span></span><br><span class="line">			&#123;</span><br><span class="line">				tem_max_min_disp[<span class="number">0</span>] = tem_max_min_conl[<span class="number">0</span>]; </span><br><span class="line">				tem_max_min_disp[<span class="number">1</span>] = tem_max_min_conl[<span class="number">1</span>];	 			</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>  <span class="comment">//进入数据显示</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (tem_max_min_disp[<span class="number">0</span>] &gt;= tem_max_min_disp[<span class="number">1</span>]) <span class="comment">//数据合理</span></span><br><span class="line">				&#123;    <span class="comment">//把设置的赋值给 控制值</span></span><br><span class="line">					tem_max_min_conl[<span class="number">0</span>] = tem_max_min_disp[<span class="number">0</span>] ;</span><br><span class="line">					tem_max_min_conl[<span class="number">1</span>] = tem_max_min_disp[<span class="number">1</span>] ;</span><br><span class="line">				&#125;				</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="DS1302-时钟"><a href="#DS1302-时钟" class="headerlink" title="DS1302  时钟"></a>DS1302  时钟</h2><p>添加头文件 ：#include “ds1302.h”  	</p>
<p>上电时 设置 初始化</p>
<p>BCD码的形式 要   &#x2F;16   %16 </p>
<p>1.定义一个数组 给他初始值   注意设置 时间 时  要  加    0x  ！！！！！！  初始值 00 也要加0x   —&gt; 0x00</p>
<p>unsigned char rtc[3] &#x3D; { 0x23 ,0x25 ,0x00};</p>
<p>2.上电时 设置 初始化 要在 while循环外：把设置的初始值给到 ds1302</p>
<p>Set_Rtc(rtc); </p>
<p>3.定义一个接收 时间的数组</p>
<p>  unsigned char rtc_buff [ ] ;</p>
<p>4.在 循环内 把数据  从  ds1302 中 接收下来</p>
<p>​    注意   BCD码的形式 要   &#x2F;16   %16  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Read_Rtc(rtc_buff );</span><br><span class="line"></span><br><span class="line">Seg_Buf[<span class="number">3</span>] = rtc_buff[<span class="number">0</span>] /<span class="number">16</span> ;</span><br><span class="line">Seg_Buf[<span class="number">4</span>] = rtc_buff[<span class="number">0</span>] %<span class="number">16</span> ;</span><br><span class="line"></span><br><span class="line">Seg_Buf[<span class="number">6</span>] = rtc_buff[<span class="number">1</span>] /<span class="number">16</span> ;</span><br><span class="line">Seg_Buf[<span class="number">7</span>] = rtc_buff[<span class="number">1</span>] %<span class="number">16</span> ;</span><br></pre></td></tr></table></figure>



<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;intrins.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">sbit Tx = P1^<span class="number">0</span>;</span><br><span class="line">sbit Rx = P1^<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay12us</span><span class="params">()</span>		<span class="comment">//@12.000MHz</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line"></span><br><span class="line">	_nop_();</span><br><span class="line">	_nop_();</span><br><span class="line">	i = <span class="number">33</span>;</span><br><span class="line">	<span class="keyword">while</span> (--i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Ut_Wave_Init</span><span class="params">()</span> <span class="comment">//超声波初始化函数 产生8个40Mhz的方波信号</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		Tx = <span class="number">1</span>;</span><br><span class="line">		Delay12us();</span><br><span class="line">		Tx = <span class="number">0</span>;</span><br><span class="line">		Delay12us();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">Ut_Wave_Data</span><span class="params">()</span> <span class="comment">//超声波距离读取函数</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> time;<span class="comment">//时间储存变量</span></span><br><span class="line">	TMOD &amp;= <span class="number">0x0f</span>;<span class="comment">//配置定时器1计时模式</span></span><br><span class="line">	TH1 = TL1 = <span class="number">0</span>;<span class="comment">//复位计数值 等待超声波信号发出</span></span><br><span class="line">	Ut_Wave_Init();<span class="comment">//发送超声波信号</span></span><br><span class="line">	TR1 = <span class="number">1</span>;<span class="comment">//开始计时</span></span><br><span class="line">	<span class="keyword">while</span>((Rx == <span class="number">1</span>) &amp;&amp; (TF1 == <span class="number">0</span>));<span class="comment">//等待接受返回信号或者定时器溢出</span></span><br><span class="line">	TR1 = <span class="number">0</span>;<span class="comment">//停止计时</span></span><br><span class="line">	<span class="keyword">if</span>(TF1 == <span class="number">0</span>) <span class="comment">//定时器没有溢出</span></span><br><span class="line">	&#123;</span><br><span class="line">		time = TH1 &lt;&lt; <span class="number">8</span> | TL1;<span class="comment">//读取当前时间</span></span><br><span class="line">		<span class="keyword">return</span> (time * <span class="number">0.017</span>);<span class="comment">//返回距离值</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		TF1 = <span class="number">0</span>;<span class="comment">//清除溢出标志位</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="DS18B20-温度"><a href="#DS18B20-温度" class="headerlink" title="DS18B20 温度"></a>DS18B20 温度</h2><p>添加头文件 ：#include “onewire.h”</p>
<p>上电时 读取温度（不要赋值） 延时750ms</p>
<p>在 数码管函数 内 读取并赋值 温度</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;reg52.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">sbit DQ = P1^<span class="number">4</span>;  </span><br><span class="line"></span><br><span class="line"><span class="comment">//单总线内部延时函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay_OneWire</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> t)</span>  </span><br><span class="line">&#123;</span><br><span class="line">	t *= <span class="number">12</span>;</span><br><span class="line">	<span class="keyword">while</span>(t--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//单总线写操作</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Write_DS18B20</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> dat)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		DQ = <span class="number">0</span>;</span><br><span class="line">		DQ = dat&amp;<span class="number">0x01</span>;</span><br><span class="line">		Delay_OneWire(<span class="number">5</span>);</span><br><span class="line">		DQ = <span class="number">1</span>;</span><br><span class="line">		dat &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	Delay_OneWire(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//单总线读操作</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">Read_DS18B20</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> dat;</span><br><span class="line">  </span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		DQ = <span class="number">0</span>;</span><br><span class="line">		dat &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">		DQ = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(DQ)</span><br><span class="line">		&#123;</span><br><span class="line">			dat |= <span class="number">0x80</span>;</span><br><span class="line">		&#125;	    </span><br><span class="line">		Delay_OneWire(<span class="number">5</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> dat;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//DS18B20初始化</span></span><br><span class="line">bit <span class="title function_">init_ds18b20</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  	bit initflag = <span class="number">0</span>;</span><br><span class="line">  	</span><br><span class="line">  	DQ = <span class="number">1</span>;</span><br><span class="line">  	Delay_OneWire(<span class="number">12</span>);</span><br><span class="line">  	DQ = <span class="number">0</span>;</span><br><span class="line">  	Delay_OneWire(<span class="number">80</span>);</span><br><span class="line">  	DQ = <span class="number">1</span>;</span><br><span class="line">  	Delay_OneWire(<span class="number">10</span>); </span><br><span class="line">    initflag = DQ;     </span><br><span class="line">  	Delay_OneWire(<span class="number">5</span>);</span><br><span class="line">  </span><br><span class="line">  	<span class="keyword">return</span> initflag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">float</span> <span class="title function_">rd_temperature</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> low,high;</span><br><span class="line">	init_ds18b20();</span><br><span class="line">	Write_DS18B20(<span class="number">0xcc</span>);</span><br><span class="line">	Write_DS18B20(<span class="number">0x44</span>);</span><br><span class="line">	init_ds18b20();</span><br><span class="line">	Write_DS18B20(<span class="number">0xcc</span>);</span><br><span class="line">	Write_DS18B20(<span class="number">0xbe</span>);	</span><br><span class="line">	low = Read_DS18B20();</span><br><span class="line">	high = Read_DS18B20();</span><br><span class="line">	<span class="keyword">return</span> ((high&lt;&lt;<span class="number">8</span>) | low) / <span class="number">16.0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="按键-摁着不动-和-松开"><a href="#按键-摁着不动-和-松开" class="headerlink" title="按键  摁着不动 和 松开"></a>按键  摁着不动 和 松开</h2><p>在中断服务函数中 添加</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">if</span>(show_seg_mode == <span class="number">1</span>) <span class="comment">//当处于时间显示界面</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(Key_Old == <span class="number">17</span>) time_show = <span class="number">1</span>; <span class="comment">//分秒(一直按下不松手)</span></span><br><span class="line">	<span class="keyword">if</span>(Key_Up == <span class="number">17</span>)  time_show = <span class="number">0</span>; <span class="comment">//时分(松手后)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(Key_Old ==<span class="number">4</span>)   <span class="comment">// 按下 4 号 按键</span></span><br><span class="line">	seg_show_mode = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	seg_show_mode = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<h2 id="NE555-测试频率"><a href="#NE555-测试频率" class="headerlink" title="NE555 测试频率"></a>NE555 测试频率</h2><p>频率测量功能需将竞赛板 J3-SIGNAL 引脚与 P34 引脚短接</p>
<p>1.计数器0  改0ms    +      TMOD |&#x3D;0x05;  </p>
<p>2.定时器1 加  	</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ET1 = <span class="number">1</span>;    <span class="comment">//定时器中断0打开</span></span><br><span class="line">EA = <span class="number">1</span>;     <span class="comment">//总中断打开</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>3.定时器1 中断服务函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">Timer1Server</span><span class="params">()</span> interrupt 3</span><br></pre></td></tr></table></figure>

<p>4.在中断服务函数内 添加</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(++time_1000ms == <span class="number">1000</span>)    <span class="comment">//定时1s</span></span><br><span class="line">&#123;</span><br><span class="line">	time_1000ms = <span class="number">0</span>;  </span><br><span class="line">	</span><br><span class="line">	pinglv =  TH0 &lt;&lt; <span class="number">8</span> | TL0;  <span class="comment">// pinglv -&gt;频率</span></span><br><span class="line">       </span><br><span class="line">	TL0 = TH0 =<span class="number">0</span>;  <span class="comment">//计数  手动置0</span></span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5.注意在main函数（while外）添加 <u>计数器0</u> 和 <u>定时器1</u> 的 初始化函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Timer0Init();</span><br><span class="line">Timer1Init();</span><br></pre></td></tr></table></figure>



<h2 id="PCF8591-AD-DA-转换"><a href="#PCF8591-AD-DA-转换" class="headerlink" title="PCF8591      AD &#x2F; DA 转换"></a>PCF8591      AD &#x2F; DA 转换</h2><p>添加头文件：   #include “iic.h”</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Da_Write(<span class="number">51</span>*temperature)</span><br><span class="line"></span><br><span class="line">Ad_Read(  ) </span><br><span class="line">    <span class="comment">//参数：</span></span><br><span class="line">    <span class="comment">// 0x43 -&gt; 电位器 </span></span><br><span class="line">    <span class="comment">// 0x41 -&gt; 光敏电阻</span></span><br><span class="line"></span><br><span class="line"><span class="type">float</span> dianya ; <span class="comment">//电压</span></span><br><span class="line">dianya = (  Ad_Read( <span class="number">0x43</span> ) ) /<span class="number">51.0</span> ;</span><br><span class="line"><span class="comment">// 输入地址 转换器读取电压 获得 模拟值 并转换成 数字量（0 - 255）</span></span><br></pre></td></tr></table></figure>





<h2 id="AT24C02-—-EEPROM-存储器"><a href="#AT24C02-—-EEPROM-存储器" class="headerlink" title="AT24C02  —&gt; EEPROM  存储器"></a>AT24C02  —&gt; EEPROM  存储器</h2><p>添加头文件：#include “iic.h”</p>
<p>EEPROM  中 只能存储 char 类型  的  数据  ，  int型数据   可以  &#x2F; 100  解决</p>
<p>1.定义读取 存储器  的 数组 date[]</p>
<p>2.EEPROM_Write（date , 0 , 4 ）;   date：数组名    0:从第几位开始写     4：写几位数据</p>
<p>3.EEPROM_Read（date , 0 , 4 ）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;intrins.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELAY_TIME 5</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Photo_Res_Channel 0x41</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Adj_Res_Channel 0x43</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//总线引脚定义</span></span><br><span class="line">sbit SDA = P2^<span class="number">1</span>;  <span class="comment">/* 数据线 */</span></span><br><span class="line">sbit SCL = P2^<span class="number">0</span>;  <span class="comment">/* 时钟线 */</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">IIC_Delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> i)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">do</span>&#123;_nop_();&#125;</span><br><span class="line">    <span class="keyword">while</span>(i--);        </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//总线启动条件</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">IIC_Start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    SDA = <span class="number">1</span>;</span><br><span class="line">    SCL = <span class="number">1</span>;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    SDA = <span class="number">0</span>;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    SCL = <span class="number">0</span>;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//总线停止条件</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">IIC_Stop</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    SDA = <span class="number">0</span>;</span><br><span class="line">    SCL = <span class="number">1</span>;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    SDA = <span class="number">1</span>;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//发送应答</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">IIC_SendAck</span><span class="params">(bit ackbit)</span></span><br><span class="line">&#123;</span><br><span class="line">    SCL = <span class="number">0</span>;</span><br><span class="line">    SDA = ackbit;  					<span class="comment">// 0：应答，1：非应答</span></span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    SCL = <span class="number">1</span>;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    SCL = <span class="number">0</span>; </span><br><span class="line">    SDA = <span class="number">1</span>;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//等待应答</span></span><br><span class="line">bit <span class="title function_">IIC_WaitAck</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    bit ackbit;</span><br><span class="line">	</span><br><span class="line">    SCL  = <span class="number">1</span>;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    ackbit = SDA;</span><br><span class="line">    SCL = <span class="number">0</span>;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    <span class="keyword">return</span> ackbit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过I2C总线发送数据</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">IIC_SendByte</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> byt)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        SCL  = <span class="number">0</span>;</span><br><span class="line">        IIC_Delay(DELAY_TIME);</span><br><span class="line">        <span class="keyword">if</span>(byt &amp; <span class="number">0x80</span>) SDA  = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> SDA  = <span class="number">0</span>;</span><br><span class="line">        IIC_Delay(DELAY_TIME);</span><br><span class="line">        SCL = <span class="number">1</span>;</span><br><span class="line">        byt &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        IIC_Delay(DELAY_TIME);</span><br><span class="line">    &#125;</span><br><span class="line">    SCL  = <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//从I2C总线上接收数据</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">IIC_RecByte</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i, da;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">8</span>; i++)</span><br><span class="line">    &#123;   </span><br><span class="line">    	SCL = <span class="number">1</span>;</span><br><span class="line">	IIC_Delay(DELAY_TIME);</span><br><span class="line">	da &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(SDA) da |= <span class="number">1</span>;</span><br><span class="line">	SCL = <span class="number">0</span>;</span><br><span class="line">	IIC_Delay(DELAY_TIME);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> da;    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">Ad_Read</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> addr)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> temp;</span><br><span class="line">	IIC_Start();</span><br><span class="line">	IIC_SendByte(<span class="number">0x90</span>);</span><br><span class="line">	IIC_WaitAck();</span><br><span class="line">	IIC_SendByte(addr);</span><br><span class="line">	IIC_WaitAck();</span><br><span class="line">	IIC_Start();</span><br><span class="line">	IIC_SendByte(<span class="number">0x91</span>);</span><br><span class="line">	IIC_WaitAck();	</span><br><span class="line">	temp = IIC_RecByte();</span><br><span class="line">	IIC_SendAck(<span class="number">1</span>);</span><br><span class="line">	IIC_Stop();</span><br><span class="line">	<span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Da_Write</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> dat)</span></span><br><span class="line">&#123;</span><br><span class="line">	IIC_Start();</span><br><span class="line">	IIC_SendByte(<span class="number">0x90</span>);</span><br><span class="line">	IIC_WaitAck();</span><br><span class="line">	IIC_SendByte(<span class="number">0x41</span>);</span><br><span class="line">	IIC_WaitAck();</span><br><span class="line">	IIC_SendByte(dat);</span><br><span class="line">	IIC_WaitAck();	</span><br><span class="line"> 	IIC_Stop();	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//函数名：写EEPROM函数</span></span><br><span class="line"><span class="comment">//入口参数：需要写入的字符串，写入的地址(务必为8的倍数)，写入数量</span></span><br><span class="line"><span class="comment">//返回值：无</span></span><br><span class="line"><span class="comment">//函数功能：向EERPOM的某个地址写入字符串中特定数量的字符。</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">EEPROM_Write</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* EEPROM_String, <span class="type">unsigned</span> <span class="type">char</span> addr, <span class="type">unsigned</span> <span class="type">char</span> num)</span></span><br><span class="line">&#123;</span><br><span class="line">	IIC_Start();<span class="comment">//发送开启信号</span></span><br><span class="line">	IIC_SendByte(<span class="number">0xA0</span>);<span class="comment">//选择EEPROM芯片，确定写的模式</span></span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待EEPROM反馈</span></span><br><span class="line">	</span><br><span class="line">	IIC_SendByte(addr);<span class="comment">//写入要存储的数据地址</span></span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待EEPROM反馈		</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(num--)</span><br><span class="line">	&#123;</span><br><span class="line">		IIC_SendByte(*EEPROM_String++);<span class="comment">//将要写入的信息写入</span></span><br><span class="line">		IIC_WaitAck();<span class="comment">//等待EEPROM反馈		</span></span><br><span class="line">		IIC_Delay(<span class="number">200</span>);	</span><br><span class="line">	&#125;</span><br><span class="line">	IIC_Stop();<span class="comment">//停止发送	</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//函数名：读EEPROM函数</span></span><br><span class="line"><span class="comment">//入口参数：读到的数据需要存储的字符串，读取的地址(务必为8的倍数)，读取的数量</span></span><br><span class="line"><span class="comment">//返回值：无</span></span><br><span class="line"><span class="comment">//函数功能：读取EERPOM的某个地址中的数据，并存放在字符串数组中。</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">EEPROM_Read</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* EEPROM_String, <span class="type">unsigned</span> <span class="type">char</span> addr, <span class="type">unsigned</span> <span class="type">char</span> num)</span></span><br><span class="line">&#123;</span><br><span class="line">	IIC_Start();<span class="comment">//发送开启信号</span></span><br><span class="line">	IIC_SendByte(<span class="number">0xA0</span>);<span class="comment">//选择EEPROM芯片，确定写的模式</span></span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待EEPROM反馈</span></span><br><span class="line">	</span><br><span class="line">	IIC_SendByte(addr);<span class="comment">//写入要读取的数据地址</span></span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待EEPROM反馈		</span></span><br><span class="line"></span><br><span class="line">	IIC_Start();<span class="comment">//发送开启信号</span></span><br><span class="line">	IIC_SendByte(<span class="number">0xA1</span>);<span class="comment">//选择EEPROM芯片，确定读的模式</span></span><br><span class="line">	IIC_WaitAck();<span class="comment">//等待EEPROM反馈	</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(num--)</span><br><span class="line">	&#123;</span><br><span class="line">		*EEPROM_String++ = IIC_RecByte();<span class="comment">//将要写入的信息写入</span></span><br><span class="line">		<span class="keyword">if</span>(num) IIC_SendAck(<span class="number">0</span>);<span class="comment">//发送应答</span></span><br><span class="line">			<span class="keyword">else</span> IIC_SendAck(<span class="number">1</span>);<span class="comment">//不应答</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	IIC_Stop();<span class="comment">//停止发送	</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="串口"><a href="#串口" class="headerlink" title="串口"></a>串口</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 串口初始化函数 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">UartInit</span><span class="params">(<span class="type">void</span>)</span>		<span class="comment">//9600bps@12.000MHz</span></span><br><span class="line">&#123;</span><br><span class="line">	SCON = <span class="number">0x50</span>;		<span class="comment">//8位数据,可变波特率</span></span><br><span class="line">	AUXR |= <span class="number">0x01</span>;		<span class="comment">//串口1选择定时器2为波特率发生器</span></span><br><span class="line">	AUXR |= <span class="number">0x04</span>;		<span class="comment">//定时器时钟1T模式</span></span><br><span class="line">	T2L = <span class="number">0xC7</span>;		<span class="comment">//设置定时初始值</span></span><br><span class="line">	T2H = <span class="number">0xFE</span>;		<span class="comment">//设置定时初始值</span></span><br><span class="line">	AUXR |= <span class="number">0x10</span>;		<span class="comment">//定时器2开始计时</span></span><br><span class="line">	ES = <span class="number">1</span>;</span><br><span class="line">	EA = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 字节发送函数 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">SendByte</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> dat)</span></span><br><span class="line">&#123;</span><br><span class="line">	SBUF=dat;<span class="comment">//将dat数据赋给SBUF，将数据发送出去</span></span><br><span class="line">	<span class="keyword">while</span>(TI == <span class="number">0</span>);<span class="comment">//等待数据发送</span></span><br><span class="line">	TI = <span class="number">0</span>;<span class="comment">//将发送标志位清零</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 字符串发送函数 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Uart_Send_String</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *dat)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span>(*dat != <span class="string">&#x27;\0&#x27;</span>)<span class="comment">//当字符不为空时，继续发送</span></span><br><span class="line">		SendByte(*dat++);<span class="comment">//发送后指针dat加1，指向下一个字节</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="超声波"><a href="#超声波" class="headerlink" title="超声波"></a>超声波</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;intrins.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">sbit Tx = P1^<span class="number">0</span>;</span><br><span class="line">sbit Rx = P1^<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay12us</span><span class="params">()</span>		<span class="comment">//@12.000MHz</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line"></span><br><span class="line">	_nop_();</span><br><span class="line">	_nop_();</span><br><span class="line">	i = <span class="number">33</span>;</span><br><span class="line">	<span class="keyword">while</span> (--i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Ut_Wave_Init</span><span class="params">()</span> <span class="comment">//超声波初始化函数 产生8个40Mhz的方波信号</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		Tx = <span class="number">1</span>;</span><br><span class="line">		Delay12us();</span><br><span class="line">		Tx = <span class="number">0</span>;</span><br><span class="line">		Delay12us();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">Ut_Wave_Data</span><span class="params">()</span> <span class="comment">//超声波距离读取函数</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> time;<span class="comment">//时间储存变量</span></span><br><span class="line">	TMOD &amp;= <span class="number">0x0f</span>;<span class="comment">//配置定时器1计时模式</span></span><br><span class="line">	TH1 = TL1 = <span class="number">0</span>;<span class="comment">//复位计数值 等待超声波信号发出</span></span><br><span class="line">	Ut_Wave_Init();<span class="comment">//发送超声波信号</span></span><br><span class="line">	TR1 = <span class="number">1</span>;<span class="comment">//开始计时</span></span><br><span class="line">	<span class="keyword">while</span>((Rx == <span class="number">1</span>) &amp;&amp; (TF1 == <span class="number">0</span>));<span class="comment">//等待接受返回信号或者定时器溢出</span></span><br><span class="line">	TR1 = <span class="number">0</span>;<span class="comment">//停止计时</span></span><br><span class="line">	<span class="keyword">if</span>(TF1 == <span class="number">0</span>) <span class="comment">//定时器没有溢出</span></span><br><span class="line">	&#123;</span><br><span class="line">		time = TH1 &lt;&lt; <span class="number">8</span> | TL1;<span class="comment">//读取当前时间</span></span><br><span class="line">		<span class="keyword">return</span> (time * <span class="number">0.017</span>);<span class="comment">//返回距离值</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		TF1 = <span class="number">0</span>;<span class="comment">//清除溢出标志位</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="PWM"><a href="#PWM" class="headerlink" title="PWM"></a>PWM</h2><p>1.设置 计时 一般12ms      0 —&gt; 12</p>
<p>2.设置亮度等级                1，2 ，3 ，4</p>
<p>3.当 亮度等级 *4 大于 计时置 时</p>
<p>   led亮</p>
<p>否则 </p>
<p>  led灭</p>
<p>即 亮度等级 越大  led亮的时间越长  </p>
<p>———————|_____________________</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( **  &gt;  s)</span><br><span class="line">    led 亮</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    led 灭</span><br></pre></td></tr></table></figure>











<p>&lt;表达式1&gt;?&lt;表达式2&gt;:&lt;表达式3&gt;</p>
<p>它是对第一个表达式作真&#x2F;假检测，然后根据结果返回另外两个表达式中的一个。在运算中，首先对第一个表达式进行检验，如果为真，则返回表达式2的值；如果为假，则返回表达式3的值。</p>
<h2 id="第九届省赛"><a href="#第九届省赛" class="headerlink" title="第九届省赛"></a>第九届省赛</h2><p>注意数组 下标   ！！！！</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(Ms_Tick == Led_Time_Ctrol[Led_Mode]) <span class="comment">//系统计时时间达到流转时间间隔  ， Ms_Tick在 中断 中加加 （在led启动时） </span></span><br><span class="line">		&#123;      </span><br><span class="line">			Ms_Tick = <span class="number">0</span>; <span class="comment">//复位计时 便于下次进入</span></span><br><span class="line">			<span class="keyword">switch</span>(Led_Mode)    <span class="comment">//Led_Mode 默认为0 </span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">0</span>:<span class="comment">//模式1-从L1到L8</span></span><br><span class="line">					<span class="keyword">if</span>(++Led_Pos == <span class="number">8</span>)</span><br><span class="line">					&#123;</span><br><span class="line">						Led_Pos = <span class="number">7</span>;<span class="comment">//模式2起始值</span></span><br><span class="line">						Led_Mode = <span class="number">1</span>;<span class="comment">//切换到模式2</span></span><br><span class="line">					&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">1</span>:<span class="comment">//模式2-从L8到L1</span></span><br><span class="line">					<span class="keyword">if</span>(--Led_Pos == <span class="number">255</span>)   <span class="comment">//从7 一直减 到 0</span></span><br><span class="line">					&#123;</span><br><span class="line">						Led_Pos = <span class="number">07</span>;<span class="comment">//模式3起始值</span></span><br><span class="line">						Led_Mode = <span class="number">2</span>;<span class="comment">//切换到模式3</span></span><br><span class="line">					&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">2</span>:<span class="comment">//模式3-    07 16 25 34</span></span><br><span class="line">					Led_Pos += <span class="number">9</span>;</span><br><span class="line">					<span class="keyword">if</span>(Led_Pos &gt; <span class="number">34</span>)</span><br><span class="line">					&#123;</span><br><span class="line">						Led_Pos = <span class="number">34</span>;<span class="comment">//模式4起始值</span></span><br><span class="line">						Led_Mode = <span class="number">3</span>;<span class="comment">//切换到模式4</span></span><br><span class="line">					&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">3</span>:<span class="comment">//模式4-34 25 16 07</span></span><br><span class="line">					Led_Pos -= <span class="number">9</span>;</span><br><span class="line">					<span class="keyword">if</span>(Led_Pos &gt; <span class="number">200</span>)</span><br><span class="line">					&#123;</span><br><span class="line">						Led_Pos = <span class="number">0</span>;<span class="comment">//模式1起始值</span></span><br><span class="line">						Led_Mode = <span class="number">0</span>;<span class="comment">//切换到模式1</span></span><br><span class="line">					&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span>(Led_Mode &lt;= <span class="number">1</span>) <span class="comment">//系统处于前两种流转模式时</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	 ucLed[i] = (i == Led_Pos);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="comment">//系统处于后两种流转模式时</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">		ucLed[i] = ((i == (Led_Pos / <span class="number">10</span>)) || (i == (Led_Pos % <span class="number">10</span>))); <span class="comment">//点亮十位跟个位所对应的Led</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="第八届-省赛"><a href="#第八届-省赛" class="headerlink" title="第八届 省赛"></a>第八届 省赛</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(time_set_clock[<span class="number">0</span>] % <span class="number">16</span> == <span class="number">0x0a</span>) <span class="comment">// 16进制 </span></span><br><span class="line">	time_set_clock[<span class="number">0</span>] = time_set_clock[<span class="number">0</span>] + <span class="number">6</span> ;</span><br><span class="line"><span class="keyword">if</span>(time_set_clock[<span class="number">0</span>] == <span class="number">0x24</span>)   <span class="comment">// 设置上限</span></span><br><span class="line">	time_set_clock = <span class="number">0x23</span> ;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="第七届省赛"><a href="#第七届省赛" class="headerlink" title="第七届省赛"></a>第七届省赛</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输出脉宽调制信号控制电机运行状态，信号频率为 <span class="number">1</span>KHz。</span><br><span class="line"> “睡眠风”模式下，对应 PWM 占空比为 <span class="number">20</span>%；</span><br></pre></td></tr></table></figure>

<p>1k hz 频率 &#x3D; 周期为 1ms</p>
<p>在 1ms 内 其中有 20% 为 高电平   | 80% 为 低电平</p>
<p>因此  再 分割成 0.1ms   即 100微妙  进入一次 中断 </p>
<h2 id="第六届省赛"><a href="#第六届省赛" class="headerlink" title="第六届省赛"></a>第六届省赛</h2><p>注意 中断计时 时 ，变量 int 和 char  的取值 范围 </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">if</span>(++col_time_show == col[col_index] *<span class="number">1000</span> ) </span><br><span class="line">&#123;</span><br><span class="line">	col_time_show = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述代码 如果 col_time_show 为 char型 永远不会执行 函数体内 的代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">if</span>(++col_time_show == col[col_index] *<span class="number">1000</span> ) <span class="comment">// 中断服务函数 中的一段代码</span></span><br><span class="line">&#123;</span><br><span class="line">	col_time_show = <span class="number">0</span> ;  <span class="comment">//重置</span></span><br><span class="line">	tem[tem_index] = rd_temperature(); <span class="comment">// 读取温度值</span></span><br><span class="line">	tem_index = tem_index +<span class="number">1</span>;   <span class="comment">// 索引值 加1 </span></span><br><span class="line">	<span class="keyword">if</span>(tem_index == <span class="number">10</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		tem_index = <span class="number">0</span>;     <span class="comment">//重置  索引值</span></span><br><span class="line">		seg_show_mode = <span class="number">3</span>;</span><br><span class="line">		start = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>中断中 最好不要添加 相关读取函数  </p>
<p>如果 把 上述 代码中 的</p>
<p>修改成</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>（seg_show_mode == <span class="number">2</span>）</span><br><span class="line">    sys_start ++ ;</span><br><span class="line"><span class="comment">//中断 服务函数 中的一段代码</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (sys_start == col[col_index] *<span class="number">1000</span>)</span><br><span class="line">&#123;</span><br><span class="line">    sys_start = <span class="number">0</span>;</span><br><span class="line">    tem[tem_index] = rd_temperature();</span><br><span class="line">    <span class="keyword">if</span>(tem_index == <span class="number">10</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		tem_index = <span class="number">0</span>;     <span class="comment">//重置  索引值</span></span><br><span class="line">		seg_show_mode = <span class="number">3</span>;</span><br><span class="line">	&#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//数码管 处理函数 中的一段代码</span></span><br></pre></td></tr></table></figure>



<p>出现问题：</p>
<p>中断服务函数————&gt;每1ms进入一次，每进入一次 sys_start +1</p>
<p>而 此时 在这1ms 内  程序可能 运行不到 数码管处理函数 中的 if判断</p>
<p>从而 导致 if 语句中  的代码 始终 无法执行  </p>
<p>解决办法 ：设置 中间变量 延长 1ms  ——&gt; 1s</p>
<h2 id="第五届省赛"><a href="#第五届省赛" class="headerlink" title="第五届省赛"></a>第五届省赛</h2><p>EEPROM_Write（&amp;date , 0 , 4 ）;   &amp;date：变量 地址    0:从第几位开始写     4：写几位数据</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ArdrewChen/TennisCar">https://github.com/ArdrewChen/TennisCar</a></p>
<p>第十四届省赛</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> light ; <span class="comment">// 光敏电阻 检测标志位</span></span><br><span class="line">bit light_right =<span class="number">0</span>; <span class="comment">// 光敏电阻 亮 检测</span></span><br><span class="line">bit start_light = <span class="number">0</span>; <span class="comment">// 触发 采集功能</span></span><br><span class="line">bit light_3s_flag = <span class="number">0</span> ; <span class="comment">// 3s计时</span></span><br><span class="line">bit flag_light = <span class="number">1</span>;  <span class="comment">// 允许 检测 亮</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> light_3000 ; <span class="comment">// 中断 3000 计时</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//检测 光敏电阻 状态</span></span><br><span class="line">light = Ad_Read(<span class="number">0x41</span>);</span><br><span class="line"><span class="keyword">if</span>(flag_light &amp;&amp; light &gt; <span class="number">128</span>)  <span class="comment">// 亮</span></span><br><span class="line">&#123;</span><br><span class="line">	</span><br><span class="line">	light_right = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(light_right &amp;&amp; light &lt; <span class="number">128</span>) <span class="comment">//变成 暗</span></span><br><span class="line">&#123;</span><br><span class="line">	light_right = <span class="number">0</span>;  <span class="comment">//光敏电阻 亮 检测 置0</span></span><br><span class="line">	</span><br><span class="line">	flag_light = <span class="number">0</span>; <span class="comment">//不允许检测 亮 状态</span></span><br><span class="line">	</span><br><span class="line">	start_light = <span class="number">1</span>;  <span class="comment">//触发采集功能</span></span><br><span class="line">	</span><br><span class="line">	light_3s_flag = <span class="number">1</span>;<span class="comment">// 开始 计时 3s	</span></span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(light_3s_flag == <span class="number">1</span>)  <span class="comment">// 开始计时</span></span><br><span class="line">&#123;	</span><br><span class="line">	<span class="keyword">if</span>(++light_3000 == <span class="number">3000</span>)   <span class="comment">// 3s 后  </span></span><br><span class="line">	&#123;</span><br><span class="line">		light_3000 = <span class="number">0</span>; <span class="comment">// 中断 计数 置0 </span></span><br><span class="line">		light_3s_flag = <span class="number">0</span> ; <span class="comment">// 停止 进入 3s计时中断</span></span><br><span class="line">		</span><br><span class="line">		flag_light = <span class="number">1</span>; <span class="comment">//允许检测 亮 状态</span></span><br><span class="line">		start_light = <span class="number">0</span> ;  <span class="comment">//触发采集功能 结束	</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>出现问题：</p>
<p>可能的原因</p>
<ul>
<li><strong>内存分配不足</strong>：程序试图分配超过目标平台或编译器限制的内存空间。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">*** ERROR L107: ADDRESS SPACE OVERFLOW</span><br><span class="line">    SPACE:   DATA    </span><br><span class="line">    SEGMENT: ?DT?SEG</span><br><span class="line">    LENGTH:  <span class="number">0019</span>H</span><br><span class="line">*** ERROR L105: PUBLIC REFERS TO IGNORED SEGMENT</span><br><span class="line">    SYMBOL:  SEG_WELA</span><br><span class="line">    SEGMENT: ?DT?SEG</span><br><span class="line">*** ERROR L105: PUBLIC REFERS TO IGNORED SEGMENT</span><br><span class="line">    SYMBOL:  SEG_DULA</span><br><span class="line">    SEGMENT: ?DT?SEG</span><br><span class="line">Program Size: data=<span class="number">128.6</span> xdata=<span class="number">0</span> code=<span class="number">2939</span></span><br></pre></td></tr></table></figure>

<h2 id="头文件"><a href="#头文件" class="headerlink" title="头文件"></a>头文件</h2><p>自己写的用双引号，第三方库或者系统的库的头文件用尖括号</p>
<h1 id="郭天祥—-定时器中断"><a href="#郭天祥—-定时器中断" class="headerlink" title="郭天祥—&gt; 定时器中断"></a>郭天祥—&gt; 定时器中断</h1><p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625232927776.png" alt="image-20240625232927776"></p>
<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625233318680.png" alt="image-20240625233318680"></p>
<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625233759954.png" alt="image-20240625233759954"></p>
<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625234255605.png" alt="image-20240625234255605"></p>
<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625234437767.png" alt="image-20240625234437767"></p>
<h1 id="郭天祥-串口"><a href="#郭天祥-串口" class="headerlink" title="郭天祥-&gt;串口"></a>郭天祥-&gt;串口</h1><p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625235150291.png" alt="image-20240625235150291"></p>
<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625235325174.png" alt="image-20240625235325174"></p>
<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625235439511.png" alt="image-20240625235439511"></p>
<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625235739307.png" alt="image-20240625235739307"></p>
<p><img src="https://cdn.jsdelivr.net/gh/dmyuena/yuena_blog_imgs/image-20240625235914088.png" alt="image-20240625235914088"></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="followme">
  <span>欢迎关注我的其它发布渠道</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="/yuena.blog/images/IMG_4653.PNG">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </a>
      </div>
  </div>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/yuena.blog/2023/08/30/hello-world/" rel="prev" title="Hello World">
                  <i class="fa fa-angle-left"></i> Hello World
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/yuena.blog/2023/10/09/git-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" rel="next" title="git 常用命令">
                  git 常用命令 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">chouzhen</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">219k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">3:19</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/yuena.blog/js/comments.js"></script><script src="/yuena.blog/js/utils.js"></script><script src="/yuena.blog/js/motion.js"></script><script src="/yuena.blog/js/next-boot.js"></script>

  




  <script src="/yuena.blog/js/third-party/pace.js"></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






<!--页面点击小桃心-->

  <script type="text/javascript" src="/js/love.js"></script>





<script src="/yuena.blog/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/yuena.blog/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
